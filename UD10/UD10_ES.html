<!DOCTYPE html>

<html class="no-js" lang="es"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><link href="https://martinezpenya.es/1DAMProgramacion/UD10/UD10_ES.html" rel="canonical"/><link href="../UD09/UD09_T04_Calculadora_en_JavaFX_IntelliJ_ES.html" rel="prev"/><link href="UD10_ejercicios_ES.html" rel="next"/><link href="../assets/favicon.ico" rel="icon"/><meta content="mkdocs-1.6.1, mkdocs-material-9.7.1" name="generator"/><title>BB.DD. relacionales - 1º Programacion (CFGS Desarrollo de Aplicaciones Multiplataforma)</title><link href="../assets/stylesheets/main.484c7ddc.min.css" rel="stylesheet"/><link href="../assets/stylesheets/palette.ab4e12ef.min.css" rel="stylesheet"/><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M384%20512H96c-53%200-96-43-96-96V96C0%2043%2043%200%2096%200h304c26.5%200%2048%2021.5%2048%2048v288c0%2020.9-13.4%2038.7-32%2045.3V448c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032zM96%20384c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v-64zm32-232c0%2013.3%2010.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24H152c-13.3%200-24%2010.7-24%2024m24%2072c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-32-352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200m-8%2064h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M434.8%2070.1c14.3%2010.4%2017.5%2030.4%207.1%2044.7l-256%20352c-5.5%207.6-14%2012.3-23.4%2013.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l101.5%20101.5%20234-321.7c10.4-14.3%2030.4-17.5%2044.7-7.1z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m0-336c-17.7%200-32%2014.3-32%2032%200%2013.3-10.7%2024-24%2024s-24-10.7-24-24c0-44.2%2035.8-80%2080-80s80%2035.8%2080%2080c0%2047.2-36%2067.2-56%2074.5v3.8c0%2013.3-10.7%2024-24%2024s-24-10.7-24-24v-8.1c0-20.5%2014.8-35.2%2030.1-40.2%206.4-2.1%2013.2-5.5%2018.2-10.3%204.3-4.2%207.7-10%207.7-19.6%200-17.7-14.3-32-32-32zm-32%20192a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.2-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20352a32%2032%200%201%200%200%2064%2032%2032%200%201%200%200-64m0-192c-18.2%200-32.7%2015.5-31.4%2033.7l7.4%20104c.9%2012.5%2011.4%2022.3%2023.9%2022.3%2012.6%200%2023-9.7%2023.9-22.3l7.4-104c1.3-18.2-13.1-33.7-31.4-33.7z%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M480-16c6.9%200%2013%204.4%2015.2%2010.9l13.5%2040.4%2040.4%2013.5C555.6%2051%20560%2057.1%20560%2064s-4.4%2013-10.9%2015.2l-40.4%2013.5-13.5%2040.4c-2.2%206.5-8.3%2010.9-15.2%2010.9s-13-4.4-15.2-10.9l-13.5-40.4-40.4-13.5C404.4%2077%20400%2070.9%20400%2064s4.4-13%2010.9-15.2l40.4-13.5%2013.5-40.4C467-11.6%20473.1-16%20480-16M321.4%2097.4c12.5-12.5%2032.8-12.5%2045.3%200l80%2080c12.5%2012.5%2012.5%2032.8%200%2045.3l-10.9%2010.9c7.9%2022%2012.2%2045.7%2012.2%2070.5%200%20114.9-93.1%20208-208%20208S32%20418.9%2032%20304%20125.1%2096%20240%2096c24.7%200%2048.5%204.3%2070.5%2012.3zM144%20304c0-53%2043-96%2096-96%2013.3%200%2024-10.7%2024-24s-10.7-24-24-24c-79.5%200-144%2064.5-144%20144%200%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M352%200c0-17.7-14.3-32-32-32s-32%2014.3-32%2032v64h-96c-53%200-96%2043-96%2096v224c0%2053%2043%2096%2096%2096h256c53%200%2096-43%2096-96V160c0-53-43-96-96-96h-96zM160%20368c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24M224%20176a48%2048%200%201%201%200%2096%2048%2048%200%201%201%200-96m144%2048a48%2048%200%201%201%2096%200%2048%2048%200%201%201-96%200m-304%200c0-17.7-14.3-32-32-32S0%20206.3%200%20224v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32zm544-32c-17.7%200-32%2014.3-32%2032v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32v-96c0-17.7-14.3-32-32-32%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20384%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M277.8%20312.9c9.8-6.7%2023.4-12.5%2023.4-12.5s-38.7%207-77.2%2010.2c-47.1%203.9-97.7%204.7-123.1%201.3-60.1-8%2033-30.1%2033-30.1s-36.1-2.4-80.6%2019c-52.5%2025.4%20130%2037%20224.5%2012.1m-85.4-32.1c-19-42.7-83.1-80.2%200-145.8C296.1%2053.2%20242.9%200%20242.9%200c21.5%2084.5-75.6%20110.1-110.7%20162.6-23.9%2035.9%2011.7%2074.4%2060.2%20118.2M307%20104.6c.1%200-175.2%2043.8-91.5%20140.2%2024.7%2028.4-6.5%2054-6.5%2054s62.7-32.4%2033.9-72.9c-26.9-37.8-47.5-56.6%2064.1-121.3m-6.1%20270.5c-.5%201-1.2%201.8-2%202.6%20128.3-33.7%2081.1-118.9%2019.8-97.3-3.3%201.2-6.2%203.4-8.2%206.3%203.6-1.3%207.3-2.3%2011-3%2031-6.5%2075.5%2041.5-20.6%2091.4m47.1%2062.3s14.5%2011.9-15.9%2021.2c-57.9%2017.5-240.8%2022.8-291.6.7-18.3-7.9%2016-19%2026.8-21.3%2011.2-2.4%2017.7-2%2017.7-2-20.3-14.3-131.3%2028.1-56.4%2040.2C232.8%20509.4%20401%20461.3%20348%20437.4M124.5%20396c-78.7%2022%2047.9%2067.4%20148.1%2024.5q-14.7-5.7-28.2-13.8c-44.7%208.5-65.4%209.1-106%204.5-33.5-3.8-13.9-15.2-13.9-15.2m179.8%2097.2C225.6%20508%20128.5%20506.3%2071%20496.8c0-.1%2011.8%209.7%2072.4%2013.6%2092.2%205.9%20233.8-3.3%20237.1-46.9%200%200-6.4%2016.5-76.2%2029.7M260.7%20353c-59.2%2011.4-93.5%2011.1-136.8%206.6-33.5-3.5-11.6-19.7-11.6-19.7-86.8%2028.8%2048.2%2061.4%20169.5%2025.9-7.8-2.8-15-7.1-21.1-12.8%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64zm256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64z%22/%3E%3C/svg%3E');}</style><script src="https://unpkg.com/iframe-worker/shim"></script><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../css/extra.css" rel="stylesheet"/><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href="../assets/stylesheets/extra-style.d5_12p2s.min.css" rel="stylesheet"/></head> <body data-md-color-accent="light-blue" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#acceso-a-bases-de-datos-relacionales"> Saltar a contenido </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow" data-md-component="header"> <nav aria-label="Cabecera" class="md-header__inner md-grid"> <a aria-label="1º Programacion (CFGS Desarrollo de Aplicaciones Multiplataforma)" class="md-header__button md-logo" data-md-component="logo" href=".." title="1º Programacion (CFGS Desarrollo de Aplicaciones Multiplataforma)"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M16.5 6.08s-6.84 1.71-3.56 5.48c.97 1.11-.25 2.11-.25 2.11s2.45-1.25 1.31-2.85c-1.06-1.47-1.86-2.2 2.5-4.74m-4.47 1.2C16.08 4.08 14 2 14 2c.84 3.3-2.96 4.3-4.33 6.36-.94 1.4.46 2.91 2.33 4.64-.71-1.7-3.22-3.16.03-5.72M9.37 17.47c-3.08.86 1.88 2.63 5.79.96-.38-.15-.75-.33-1.1-.54-1.36.31-2.76.37-4.14.18-1.31-.16-.55-.6-.55-.6m5.32-1.68c-1.75.38-3.56.47-5.34.26-1.31-.13-.45-.77-.45-.77-3.4 1.13 1.88 2.4 6.6 1.02-.29-.11-.57-.3-.81-.51m3.42 3.3s.57.47-.61.83c-2.28.68-9.43.89-11.41.03-.71-.31.63-.74 1.05-.83.23-.06.46-.08.69-.08-.79-.54-5.13 1.1-2.19 1.56 7.97 1.3 14.54-.6 12.47-1.51m-2.74-4.86c.29-.19.6-.35.92-.49 0 0-1.51.26-3.02.4-1.6.16-3.21.18-4.81.06-2.35-.31 1.29-1.2 1.29-1.2-1.1 0-2.18.26-3.16.75-2.05 1 5.1 1.45 8.78.48m.9 2.42c-.02.04-.04.07-.08.1 5.01-1.31 3.17-4.64.77-3.81-.13.06-.24.14-.31.25.14-.05.28-.09.43-.12 1.2-.24 2.92 1.63-.81 3.58m.13 4.61c-3.01.52-6.09.56-9.12.14 0 0 .46.38 2.81.53 3.6.23 9.13-.13 9.26-1.83.03.01-.23.65-2.95 1.16"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> 1º Programacion (CFGS Desarrollo de Aplicaciones Multiplataforma) </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> BB.DD. relacionales </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Light mode" class="md-option" data-md-color-accent="light-blue" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg> </label> <input aria-label="Dark mode" class="md-option" data-md-color-accent="light-blue" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_0" hidden="" title="Dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Búsqueda" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Búsqueda" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav aria-label="Buscar" class="md-search__options"> <button aria-label="Limpiar" class="md-search__icon md-icon" tabindex="-1" title="Limpiar" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0"> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Inicializando búsqueda </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a class="md-source" data-md-component="source" href="https://github.com/martinezpenya/1DAMProgramacion" title="Ir al repositorio"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> GitHub </div> </a> </div> <a class="md-header-nav__button md-icon" href="../docs/Libro.pdf" title="PDF">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
<path d="M128,0c-17.6,0-32,14.4-32,32v448c0,17.6,14.4,32,32,32h320c17.6,0,32-14.4,32-32V128L352,0H128z" fill="#E2E5E7"></path>
<path d="m384 128h96l-128-128v96c0 17.6 14.4 32 32 32z" fill="#B0B7BD"></path>
<polygon fill="#CAD1D8" points="480 224 384 128 480 128"></polygon>
<path d="M416,416c0,8.8-7.2,16-16,16H48c-8.8,0-16-7.2-16-16V256c0-8.8,7.2-16,16-16h352c8.8,0,16,7.2,16,16  V416z" fill="#F15642"></path>
<g fill="#fff">
<path d="m101.74 303.15c0-4.224 3.328-8.832 8.688-8.832h29.552c16.64 0 31.616 11.136 31.616 32.48 0 20.224-14.976 31.488-31.616 31.488h-21.36v16.896c0 5.632-3.584 8.816-8.192 8.816-4.224 0-8.688-3.184-8.688-8.816v-72.032zm16.88 7.28v31.872h21.36c8.576 0 15.36-7.568 15.36-15.504 0-8.944-6.784-16.368-15.36-16.368h-21.36z"></path>
<path d="m196.66 384c-4.224 0-8.832-2.304-8.832-7.92v-72.672c0-4.592 4.608-7.936 8.832-7.936h29.296c58.464 0 57.184 88.528 1.152 88.528h-30.448zm8.064-72.912v57.312h21.232c34.544 0 36.08-57.312 0-57.312h-21.232z"></path>
<path d="m303.87 312.11v20.336h32.624c4.608 0 9.216 4.608 9.216 9.072 0 4.224-4.608 7.68-9.216 7.68h-32.624v26.864c0 4.48-3.184 7.92-7.664 7.92-5.632 0-9.072-3.44-9.072-7.92v-72.672c0-4.592 3.456-7.936 9.072-7.936h44.912c5.632 0 8.96 3.344 8.96 7.936 0 4.096-3.328 8.704-8.96 8.704h-37.248v0.016z"></path>
</g>
<path d="m400 432h-304v16h304c8.8 0 16-7.2 16-16v-16c0 8.8-7.2 16-16 16z" fill="#CAD1D8"></path>
</svg>
</a></nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navegación" class="md-nav md-nav--primary md-nav--integrated" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="1º Programacion (CFGS Desarrollo de Aplicaciones Multiplataforma)" class="md-nav__button md-logo" data-md-component="logo" href=".." title="1º Programacion (CFGS Desarrollo de Aplicaciones Multiplataforma)"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M16.5 6.08s-6.84 1.71-3.56 5.48c.97 1.11-.25 2.11-.25 2.11s2.45-1.25 1.31-2.85c-1.06-1.47-1.86-2.2 2.5-4.74m-4.47 1.2C16.08 4.08 14 2 14 2c.84 3.3-2.96 4.3-4.33 6.36-.94 1.4.46 2.91 2.33 4.64-.71-1.7-3.22-3.16.03-5.72M9.37 17.47c-3.08.86 1.88 2.63 5.79.96-.38-.15-.75-.33-1.1-.54-1.36.31-2.76.37-4.14.18-1.31-.16-.55-.6-.55-.6m5.32-1.68c-1.75.38-3.56.47-5.34.26-1.31-.13-.45-.77-.45-.77-3.4 1.13 1.88 2.4 6.6 1.02-.29-.11-.57-.3-.81-.51m3.42 3.3s.57.47-.61.83c-2.28.68-9.43.89-11.41.03-.71-.31.63-.74 1.05-.83.23-.06.46-.08.69-.08-.79-.54-5.13 1.1-2.19 1.56 7.97 1.3 14.54-.6 12.47-1.51m-2.74-4.86c.29-.19.6-.35.92-.49 0 0-1.51.26-3.02.4-1.6.16-3.21.18-4.81.06-2.35-.31 1.29-1.2 1.29-1.2-1.1 0-2.18.26-3.16.75-2.05 1 5.1 1.45 8.78.48m.9 2.42c-.02.04-.04.07-.08.1 5.01-1.31 3.17-4.64.77-3.81-.13.06-.24.14-.31.25.14-.05.28-.09.43-.12 1.2-.24 2.92 1.63-.81 3.58m.13 4.61c-3.01.52-6.09.56-9.12.14 0 0 .46.38 2.81.53 3.6.23 9.13-.13 9.26-1.83.03.01-.23.65-2.95 1.16"></path></svg> </a> 1º Programacion (CFGS Desarrollo de Aplicaciones Multiplataforma) </label> <div class="md-nav__source"> <a class="md-source" data-md-component="source" href="https://github.com/martinezpenya/1DAMProgramacion" title="Ir al repositorio"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> GitHub </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/> <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0"> <span class="md-ellipsis"> UD00 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_1"> <span class="md-nav__icon md-icon"></span> UD00 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../index.html"> <span class="md-ellipsis"> Información importante </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/> <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0"> <span class="md-ellipsis"> UD01 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> UD01 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD01/UD01_ES.html"> <span class="md-ellipsis"> Elementos de un programa informático </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD01/UD01_ejercicios_ES.html"> <span class="md-ellipsis"> Ejercicios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_2_3" type="checkbox"/> <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0"> <span class="md-ellipsis"> Talleres </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_2_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_2_3"> <span class="md-nav__icon md-icon"></span> Talleres </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD01/UD01_T01_NoMachine.html"> <span class="md-ellipsis"> T01 NoMachine </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD01/UD01_T02_JDK%26IDE.html"> <span class="md-ellipsis"> T02 JDK e IDE </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD01/UD01_T03_GitHub.html"> <span class="md-ellipsis"> T03 GitHub </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD01/UD01_T04_Markdown.html"> <span class="md-ellipsis"> T04 Markdown </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0"> <span class="md-ellipsis"> UD02 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> UD02 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD02/UD02_ES.html"> <span class="md-ellipsis"> Utilización de Objetos y Clases </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD02/UD02_ejercicios_ES.html"> <span class="md-ellipsis"> Ejercicios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0"> <span class="md-ellipsis"> Talleres </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_3_3"> <span class="md-nav__icon md-icon"></span> Talleres </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD02/UD02_T01_GitHubClassroom.html"> <span class="md-ellipsis"> T01 GitHub Classroom </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0"> <span class="md-ellipsis"> UD03 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> UD03 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD03/UD03_ES.html"> <span class="md-ellipsis"> Estructuras de control y Excepciones </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD03/UD03_ejercicios_ES.html"> <span class="md-ellipsis"> Ejercicios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_4_3" type="checkbox"/> <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0"> <span class="md-ellipsis"> Talleres </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_4_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_4_3"> <span class="md-nav__icon md-icon"></span> Talleres </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD03/UD03_T01_GitHubClassroom.html"> <span class="md-ellipsis"> T01 GitHub Classroom </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD03/UD03_T02_AceptaElReto.html"> <span class="md-ellipsis"> T02 Acepta el reto </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/> <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0"> <span class="md-ellipsis"> UD04 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> UD04 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD04/UD04_ES.html"> <span class="md-ellipsis"> Estructuras de datos Arrays y matrices. Recursividad </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD04/UD04_anexo_ES.html"> <span class="md-ellipsis"> Anexo Cheatsheet String </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD04/UD04_ejercicios_ES.html"> <span class="md-ellipsis"> Ejercicios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_5_4" type="checkbox"/> <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0"> <span class="md-ellipsis"> Talleres </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_4_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_5_4"> <span class="md-nav__icon md-icon"></span> Talleres </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD04/UD04_T01_GitHubClassroom.html"> <span class="md-ellipsis"> T01 GitHub Classroom </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/> <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0"> <span class="md-ellipsis"> UD05 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> UD05 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD05/UD05_ES.html"> <span class="md-ellipsis"> Desarrollo de clases </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD05/UD05_anexo_ES.html"> <span class="md-ellipsis"> Anexo Wrappers y Fechas </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD05/UD05_ejercicios_ES.html"> <span class="md-ellipsis"> Ejercicios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_6_4" type="checkbox"/> <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0"> <span class="md-ellipsis"> Talleres </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_6_4_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_6_4"> <span class="md-nav__icon md-icon"></span> Talleres </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD05/UD05_T01_GitHubClassroom.html"> <span class="md-ellipsis"> T01 GitHub Classroom </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/> <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0"> <span class="md-ellipsis"> UD06 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> UD06 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD06/UD06_ES.html"> <span class="md-ellipsis"> Lectura y escritura de información </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD06/UD06_comparativa_CRUD.html"> <span class="md-ellipsis"> Comparativa CRUD </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD06/UD06_ejercicios_ES.html"> <span class="md-ellipsis"> Ejercicios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_7_4" type="checkbox"/> <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0"> <span class="md-ellipsis"> Talleres </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_7_4_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_7_4"> <span class="md-nav__icon md-icon"></span> Talleres </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD06/UD06_T01_GitHubClassroom.html"> <span class="md-ellipsis"> T01 GitHub Classroom </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD06/UD06_T02_Sockets_ES.html"> <span class="md-ellipsis"> T02 Sockets en AWS </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_8" type="checkbox"/> <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0"> <span class="md-ellipsis"> UD07 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> UD07 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD07/UD07_ES.html"> <span class="md-ellipsis"> Colecciones </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD07/UD07_ejercicios_ES.html"> <span class="md-ellipsis"> Ejercicios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_8_3" type="checkbox"/> <label class="md-nav__link" for="__nav_8_3" id="__nav_8_3_label" tabindex="0"> <span class="md-ellipsis"> Talleres </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_8_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_8_3"> <span class="md-nav__icon md-icon"></span> Talleres </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD07/UD07_T01_GitHubClassroom.html"> <span class="md-ellipsis"> T01 GitHub Classroom </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_9" type="checkbox"/> <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0"> <span class="md-ellipsis"> UD08 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_9"> <span class="md-nav__icon md-icon"></span> UD08 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD08/UD08_ES.html"> <span class="md-ellipsis"> Composición, Herencia y Polimorfismo </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD08/UD08_ejercicios_ES.html"> <span class="md-ellipsis"> Ejercicios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_9_3" type="checkbox"/> <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0"> <span class="md-ellipsis"> Talleres </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_9_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_9_3"> <span class="md-nav__icon md-icon"></span> Talleres </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD08/UD08_T01_GitHubClassroom.html"> <span class="md-ellipsis"> T01 GitHub Classroom </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD08/UD08_T02_LibreriasMavenJar_ES.html"> <span class="md-ellipsis"> T02 Librerias Jar vs Maven </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD08/UD08_T03_JSON%26YAML_ES.html"> <span class="md-ellipsis"> T03 Json vs YAML </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_10" type="checkbox"/> <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0"> <span class="md-ellipsis"> UD09 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_10_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_10"> <span class="md-nav__icon md-icon"></span> UD09 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD09/UD09_ES.html"> <span class="md-ellipsis"> Interfaz gráfica </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD09/UD09_ejercicios_ES.html"> <span class="md-ellipsis"> Ejercicios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_10_3" type="checkbox"/> <label class="md-nav__link" for="__nav_10_3" id="__nav_10_3_label" tabindex="0"> <span class="md-ellipsis"> Talleres </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_10_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_10_3"> <span class="md-nav__icon md-icon"></span> Talleres </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD09/UD09_T01_GitHubClassroom.html"> <span class="md-ellipsis"> T01 GitHub Classroom </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD09/UD09_T02_SceneBuilder_IntelliJ_ES.html"> <span class="md-ellipsis"> T02 SceneBuilder &amp; IntelliJ </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD09/UD09_T03_ProyectoJavaFXMaven_ES.html"> <span class="md-ellipsis"> T03 Proyecto JavaFX Maven </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD09/UD09_T04_Calculadora_en_JavaFX_IntelliJ_ES.html"> <span class="md-ellipsis"> T04 Calculadora JavaFX </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_11" type="checkbox"/> <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0"> <span class="md-ellipsis"> UD10 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="true" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> UD10 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> BB.DD. relacionales </span> <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="UD10_ES.html"> <span class="md-ellipsis"> BB.DD. relacionales </span> </a> <nav aria-label="Tabla de contenidos" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#introduccion"> <span class="md-ellipsis"> Introducción </span> </a> <nav aria-label="Introducción" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#conexion-a-las-bbdd-conectores"> <span class="md-ellipsis"> Conexión a las BBDD: conectores </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#jdbc"> <span class="md-ellipsis"> JDBC </span> </a> <nav aria-label="JDBC" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#funciones-del-jdbc"> <span class="md-ellipsis"> Funciones del JDBC </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#drivers-jdbc"> <span class="md-ellipsis"> Drivers JDBC </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#instalacion-controlador"> <span class="md-ellipsis"> Instalación controlador </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#carga-del-controlador-jdbc-y-conexion-con-la-bd"> <span class="md-ellipsis"> Carga del controlador JDBC y conexión con la BD </span> </a> <nav aria-label="Carga del controlador JDBC y conexión con la BD" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#conexion-alternativa-mediante-driver"> <span class="md-ellipsis"> Conexión alternativa mediante Driver </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#patrones-de-diseno-aplicables"> <span class="md-ellipsis"> Patrones de diseño aplicables </span> </a> <nav aria-label="Patrones de diseño aplicables" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#patron-singleton"> <span class="md-ellipsis"> Patrón Singleton </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#patron-pool-object-database-pool-connection-dbpc"> <span class="md-ellipsis"> Patrón Pool Object (DataBase Pool Connection DBPC) </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#patron-dao"> <span class="md-ellipsis"> Patrón DAO </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#acceso-a-bbdd"> <span class="md-ellipsis"> Acceso a BBDD </span> </a> <nav aria-label="Acceso a BBDD" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#cargar-el-driver"> <span class="md-ellipsis"> Cargar el Driver </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#clase-drivermanager"> <span class="md-ellipsis"> Clase DriverManager </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#clase-connection"> <span class="md-ellipsis"> Clase Connection </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#clase-statement"> <span class="md-ellipsis"> Clase Statement </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#clase-resultset"> <span class="md-ellipsis"> Clase ResultSet </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#navegabilidad-y-concurrencia"> <span class="md-ellipsis"> Navegabilidad y concurrencia </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#consultas-query"> <span class="md-ellipsis"> Consultas (Query) </span> </a> <nav aria-label="Consultas (Query)" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#navegacion-de-un-resultset"> <span class="md-ellipsis"> Navegación de un ResultSet </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#obteniendo-datos-del-resultset"> <span class="md-ellipsis"> Obteniendo datos del ResultSet </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#tipos-de-datos-y-conversiones"> <span class="md-ellipsis"> Tipos de datos y conversiones </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sentencias-que-no-devuelven-datos"> <span class="md-ellipsis"> Sentencias que no devuelven datos </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#asegurar-la-liberacion-de-recursos"> <span class="md-ellipsis"> Asegurar la liberación de recursos </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#modificacion-update"> <span class="md-ellipsis"> Modificación (update) </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#insercion-insert"> <span class="md-ellipsis"> Inserción (insert) </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#borrado-delete"> <span class="md-ellipsis"> Borrado (delete) </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#sentencias-predefinidas"> <span class="md-ellipsis"> Sentencias predefinidas </span> </a> <nav aria-label="Sentencias predefinidas" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#ventajas-de-preparedstatement-desde-el-punto-de-vista-de-seguridad"> <span class="md-ellipsis"> Ventajas de PreparedStatement desde el Punto de Vista de Seguridad </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#pildoras-informaticas-relacionadas"> <span class="md-ellipsis"> Píldoras informáticas relacionadas </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="UD10_ejercicios_ES.html"> <span class="md-ellipsis"> Ejercicios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_11_3" type="checkbox"/> <label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="0"> <span class="md-ellipsis"> Talleres </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_11_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_11_3"> <span class="md-nav__icon md-icon"></span> Talleres </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="UD10_T01_GitHubClassroom.html"> <span class="md-ellipsis"> T01 GitHub Classroom </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="UD10_T02_Conectores_ES.html"> <span class="md-ellipsis"> T02 SceneBuilder &amp; IntelliJ </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="UD10_T03_AWS_IntelliJ_ES.html"> <span class="md-ellipsis"> T03 Proyecto JavaFX Maven </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="UD10_T04_DAO_ES.html"> <span class="md-ellipsis"> T04 Calculadora JavaFX </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_12" type="checkbox"/> <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0"> <span class="md-ellipsis"> UD11 </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_12_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_12"> <span class="md-nav__icon md-icon"></span> UD11 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD11/UD11_ES.html"> <span class="md-ellipsis"> BB.DD. OO </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD11/UD11_ejercicios_ES.html"> <span class="md-ellipsis"> Ejercicios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id="__nav_12_3" type="checkbox"/> <label class="md-nav__link" for="__nav_12_3" id="__nav_12_3_label" tabindex="0"> <span class="md-ellipsis"> Talleres </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_12_3_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_12_3"> <span class="md-nav__icon md-icon"></span> Talleres </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../UD11/UD11_T01_GitHubClassroom.html"> <span class="md-ellipsis"> T01 GitHub Classroom </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD11/UD11_T02_ObjectDB_ES.html"> <span class="md-ellipsis"> T02 SceneBuilder &amp; IntelliJ </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../UD11/UD11_T03_CRUD_ObjectDB_ES.html"> <span class="md-ellipsis"> T03 Proyecto JavaFX Maven </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../sobremi.html"> <span class="md-ellipsis"> Sobre mi </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../fuentes.html"> <span class="md-ellipsis"> Fuentes de información </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <a class="md-content__button md-icon" href="https://github.com/martinezpenya/1DAMProgramacion/edit/main/docs/UD10/UD10_ES.md" rel="edit" title="Editar esta página"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg> </a> <div><h1 id="acceso-a-bases-de-datos-relacionales">Acceso a Bases de Datos Relacionales<a class="headerlink" href="#acceso-a-bases-de-datos-relacionales" title="Permanent link">¶</a></h1> <p><div class="video-container"><iframe allowfullscreen="" alt="type:video" frameborder="0" src="assets/UD10_BBDD_Relacionales.mp4" style="position:relative;width:100%;height:22.172vw"></iframe></div></p> <p><img alt="Diagrama" src="assets/UD10_Diagrama.png"/></p> <h2 id="introduccion">Introducción<a class="headerlink" href="#introduccion" title="Permanent link">¶</a></h2> <p>Hoy en día, la mayoría de aplicaciones informáticas necesitan almacenar y gestionar gran cantidad de datos. Esos datos, se suelen guardar en <strong>bases de datos relacionales</strong>, ya que éstas son las más extendidas actualmente.</p> <p>Las bases de datos relacionales permiten organizar los datos en <strong>tablas</strong> y esas tablas y datos se relacionan mediante campos clave. Además se trabaja con el lenguaje estándar conocido como <strong>SQL</strong>, para poder realizar las consultas que deseemos a la base de datos.</p> <p>Una base de datos relacional se puede definir de una manera simple como aquella que presenta la información en tablas con filas y columnas.</p> <p>Una tabla es una serie de <strong>filas</strong> y <strong>columnas</strong> , en la que cada fila es un <strong>registro</strong> y cada columna es un <strong>campo</strong>. Un campo representa un dato de los elementos almacenados en la tabla (<em>NSS</em>, <em>nombre</em>, <em>etc</em>.). Cada registro representa un elemento de la tabla (el equipo Real Madrid, el equipo Real Murcia, etc.)</p> <p>No se permite que pueda aparecer dos o más veces el mismo registro, por lo que uno o más campos de la tabla forman lo que se conoce como <strong>clave primaria</strong> (atributo que se elige como identificador en una tabla, de manera que no haya dos registros iguales, sino que se diferencien al menos en esa clave. Por ejemplo, en el caso de una tabla que guarda datos de personas, el número de la seguridad social, podría elegirse como clave primaria, pues sabemos que aunque haya dos personas llamadas, por ejemplo, Juan Pérez Pérez, estamos seguros de que su número de seguridad social será distinto).</p> <p>El sistema gestor de bases de datos, en inglés conocido como: <strong>Database Management System</strong> (<strong>DBMS</strong>) , gestiona el modo en que los datos se almacenan, mantienen y recuperan.</p> <p>En el caso de una base de datos relacional, el sistema gestor de base de datos se denomina: <strong>Relational Database Management System</strong> (<strong>RDBMS</strong>).</p> <p>Tradicionalmente, la programación de bases de datos ha sido como una Torre de Babel: gran cantidad de productos de bases de datos en el mercado, y cada uno “hablando” en su lenguaje privado con las aplicaciones.</p> <p>Java, mediante <strong>JDBC</strong> ( Java Database Connectivity, API que permite la ejecución de operaciones sobre bases de datos desde el lenguaje de programación Java, independientemente del sistema operativo donde se ejecute o de la base de datos a la cual se accede), permite simplificar el acceso a base de datos , proporcionando un lenguaje mediante el cual las aplicaciones pueden comunicarse con motores de bases de datos. Sun desarrolló este API para el acceso a bases de datos, con tres objetivos principales en mente:</p> <ul> <li>Ser un API con soporte de SQL: poder construir sentencias SQL e insertarlas dentro de llamadas al API de Java,</li> <li>Aprovechar la experiencia de los APIs de bases de datos existentes,</li> <li>Ser sencillo.</li> </ul> <div class="admonition info"> <p class="admonition-title">Qué es una API?</p> <p><strong>API</strong>: <em>Application Programming Interface</em> (Interfaz de Programación de Aplicaciones). Conjunto de reglas y protocolos que permite a diferentes aplicaciones o sistemas comunicarse entre sí. En pocas palabras, actúa como un intermediario que permite que dos programas informáticos se comuniquen y compartan datos entre ellos de manera segura y eficiente. Las APIs se utilizan comúnmente en el desarrollo de software para permitir la integración de diferentes sistemas, la creación de aplicaciones de terceros y la automatización de procesos.</p> <p>Un ejemplo sencillo de API podría ser el servicio de pronóstico del tiempo proporcionado por una compañía meteorológica. Imagina que tienes una aplicación de clima en tu teléfono. Esta aplicación necesita mostrar el pronóstico del tiempo actualizado, pero no tiene la capacidad de predecir el clima por sí misma.</p> <p>En lugar de eso, la aplicación utiliza una API proporcionada por una empresa meteorológica. Esta API permite que la aplicación envíe una solicitud con la ubicación actual del usuario y, a cambio, recibe datos sobre el clima en esa ubicación. La API proporciona estos datos en un formato estructurado, como JSON o XML, que la aplicación puede interpretar y mostrar de manera comprensible para el usuario.</p> <p>En resumen, la aplicación de clima utiliza la API de la empresa meteorológica para obtener datos actualizados sobre el pronóstico del tiempo sin tener que desarrollar su propio sistema de predicción meteorológica. La API actúa como un puente entre la aplicación y los recursos de la compañía meteorológica, permitiendo que la aplicación acceda y utilice esos recursos de manera fácil y eficiente.</p> </div> <div class="admonition info"> <p class="admonition-title">Bases de datos NoSQL vs Bases de datos relacionales</p> <p>Las bases de datos NoSQL (Not Only SQL) son sistemas de gestión de bases de datos que no siguen el modelo relacional tradicional. Están diseñadas para manejar datos no estructurados o semiestructurados y para proporcionar flexibilidad en la forma en que se almacenan y acceden a los datos. Existen diferentes tipos:</p> <ul> <li><strong>Documentales:</strong> Almacenan datos en documentos similares a JSON, como <a href="https://www.mongodb.com/">MongoDB</a>.</li> <li><strong>Clave-Valor:</strong> Almacenan pares de clave-valor, como <a href="https://redis.io/">Redis</a>.</li> <li><strong>Columnar:</strong> Almacenan datos en columnas en lugar de filas, como <a href="https://cassandra.apache.org/_/index.html">Cassandra</a>.</li> <li><strong>Grafos:</strong> Almacenan datos en estructuras de grafos, como <a href="https://neo4j.com/">Neo4j</a>.</li> </ul> <p>Entre sus ventajas, podemos encontrar las siguientes:</p> <ul> <li><strong>Escalabilidad Horizontal:</strong> Pueden manejar grandes volúmenes de datos mediante la distribución de la carga en múltiples servidores.</li> <li><strong>Flexibilidad:</strong> No requieren un esquema fijo, lo que permite manejar datos heterogéneos y evolucionar el modelo de datos fácilmente.</li> <li><strong>Alto Rendimiento:</strong> Optimizadas para operaciones de lectura y escritura rápidas.</li> </ul> <p><strong>Diferencias con Bases de Datos Relacionales</strong></p> <p>Referente al Modelo de Datos, las <strong>Relacionales</strong> utilizan un modelo tabular con filas y columnas, y relaciones definidas mediante claves primarias y foráneas. Mientras que las <strong>NoSQL</strong> utilizan diversos modelos de datos (documentos, clave-valor, columnar, grafos) que permiten una mayor flexibilidad.</p> <p>En cuanto a su Esquema, las <strong>Relacionales:</strong> tienen esquemas rígidos y predefinidos. Cambiar el esquema puede ser complejo. Por contra, las <strong>NoSQL</strong> tienen esquemas dinámicos o inexistentes, permitiendo agregar nuevos campos sobre la marcha sin necesidad de modificar el esquema de la base de datos.</p> <p>Las Consultas en las <strong>Relacionales</strong> utilizan SQL (Structured Query Language) para realizar consultas complejas y uniones entre tablas. Sin embargo, las <strong>NoSQL</strong> utilizan diferentes lenguajes de consulta o API específicos para el tipo de base de datos, que pueden ser menos complejos y más rápidos para ciertas operaciones.</p> <p>Si hablamos de Escalabilidad, las <strong>Relacionales</strong> tienen escalabilidad vertical (mejorar el hardware del servidor). Pero las <strong>NoSQL</strong> cuentan con escalabilidad horizontal (añadir más servidores al clúster).</p> <p>Por último, referente a la Integridad y Transacciones, las <strong>Relacionales</strong> cuentan con una fuerte consistencia y soporte robusto para transacciones ACID (Atomicidad, Consistencia, Aislamiento, Durabilidad). Por contra, las <strong>NoSQL</strong> en muchos casos, priorizan la disponibilidad y la partición tolerante sobre la consistencia (sistema BASE: Basic Availability, Soft state, Eventual consistency).</p> </div> <h3 id="conexion-a-las-bbdd-conectores">Conexión a las BBDD: conectores<a class="headerlink" href="#conexion-a-las-bbdd-conectores" title="Permanent link">¶</a></h3> <p>Dejemos de momento de lado el desfase Objeto-Relacional y centrémonos ahora en el acceso a Base de Datos Relacionales desde los lenguajes de programación. Lo razonaremos en general y lo aplicaremos a Java.</p> <p>Desde la década de los 80 que existen a pleno rendimiento las bases de datos relacionales. Casi todos los Sistemas Gestores de Bases de Datos (excepto los más pequeños como Access, SQLite o Base de LibreOffice) utilizan la arquitectura cliente-servidor. Esto significa que hay un ordenador central donde está instalado el Sistema Gestor de Bases de Datos Relacional que actúa como servidor, y habrá muchos clientes que se conectarán al servidor haciendo peticiones sobre la Base de Datos.</p> <p>Los Sistemas Gestores de Bases de Datos inicialmente disponían de lenguajes de programación propios para poder hacer los accesos desde los clientes. Era muy consistente, pero a base de ser muy poco operativo:</p> <ul> <li>La empresa desarrolladora del SGBD debían mantener un lenguaje de programación, que resultaba necesariamente muy costoso, si no querían que quedara desfasado.</li> <li>Las empresas usuarias del SGBD, que se conectaban como clientes, se encontraban muy ligadas al servidor para tener que utilizar el lenguaje de programación para acceder al servidor, lo que no siempre se ajustaba a sus necesidades. Además, el plantearse cambiar de servidor, significaba que había que rehacer todos los programas, y por tanto una tarea de muchísima envergadura.</li> </ul> <p>Para poder ser más operativos, había que desvincular los lenguajes de programación de los Sistemas Gestores de Bases de Datos utilizando unos estándares de conexión.</p> <h2 id="jdbc">JDBC<a class="headerlink" href="#jdbc" title="Permanent link">¶</a></h2> <p>Java puede conectarse con distintos SGBD y en diferentes sistemas operativos. Independientemente del método en que se almacenen los datos debe existir siempre un <strong>mediador</strong> entre la aplicación y el sistema de base de datos y en Java esa función la realiza <strong>JDBC</strong>. </p> <div class="admonition warning"> <p class="admonition-title">Importante</p> <p>Para la conexión a las bases de datos utilizaremos la API estándar de JAVA denominada <strong>JDBC</strong> (<em>Java Data Base Connectivity</em>).</p> </div> <p>JDBC es un API incluido dentro del lenguaje Java para el acceso a bases de datos. Consiste en un conjunto de clases e interfaces escritas en Java que ofrecen un completo API para la programación con bases de datos, por lo tanto es la única solución 100% Java que permite el acceso a bases de datos.</p> <p>JDBC es una especificación formada por una colección de interfaces y clases abstractas, que todos los fabricantes de drivers deben implementar si quieren realizar una implementación de su driver 100% Java y compatible con JDBC (JDBC-compliant driver). Debido a que JDBC está escrito completamente en Java también posee la ventaja de ser independiente de la plataforma. </p> <div class="admonition warning"> <p class="admonition-title">Importante</p> <p>No será necesario escribir un programa para cada tipo de base de datos, una misma aplicación escrita utilizando JDBC podrá manejar bases de datos Oracle, Sybase, SQL Server, etc.</p> </div> <p><img alt="jdbc_rdbms" src="assets/jdbc2.png" width="400"/></p> <p>Además podrá ejecutarse en cualquier sistema operativo que posea una Máquina Virtual de Java, es decir, serán aplicaciones completamente independientes de la plataforma. Otras API'S que se suelen utilizar bastante para el acceso a bases de datos son DAO (Data Access Objects) y RDO (Remote Data Objects), y ADO (ActiveX Data Objects), pero el problema que ofrecen estas soluciones es que sólo son para plataformas Windows.</p> <p>JDBC tiene sus clases en el paquete <code>java.sql</code> y otras extensiones en el paquete <code>javax.sql</code>.</p> <p><img alt="jdbc paquetes" src="assets/jdbc_clases2.png" width="600"/></p> <h3 id="funciones-del-jdbc">Funciones del JDBC<a class="headerlink" href="#funciones-del-jdbc" title="Permanent link">¶</a></h3> <p>Básicamente el API JDBC hace posible la realización de las siguientes tareas:</p> <ul> <li>Establecer una conexión con una base de datos.</li> <li>Enviar sentencias SQL.</li> <li>Manipular datos.</li> <li>Procesar los resultados de la ejecución de las sentencias.</li> </ul> <h3 id="drivers-jdbc">Drivers JDBC<a class="headerlink" href="#drivers-jdbc" title="Permanent link">¶</a></h3> <p>Los drivers nos permiten conectarnos con una base de datos determinada. Existen <strong>cuatro tipos de drivers JDBC</strong>, cada tipo presenta una filosofía de trabajo diferente. A continuación se pasa a comentar cada uno de los drivers:</p> <ul> <li> <p><strong>JDBC-ODBC bridge plus ODBC driver</strong> (tipo 1): permite al programador acceder a fuentes de datos ODBC existentes mediante JDBC. El JDBC-ODBC Bridge (puente JDBC-ODBC) implementa operaciones JDBC traduciéndolas a operaciones ODBC, se encuentra dentro del paquete <code>sun.jdbc.odbc</code> y contiene librerías nativas para acceder a ODBC.</p> <p>Al ser usuario de ODBC depende de las dll de ODBC y eso limita la cantidad de plataformas en donde se puede ejecutar la aplicación.</p> </li> <li> <p><strong>Native-API partly-Java driver</strong> (tipo 2): son similares a los drivers de tipo1, en tanto en cuanto también necesitan una configuración en la máquina cliente. Este tipo de driver convierte llamadas JDBC a llamadas de Oracle, Sybase, Informix, DB2 u otros SGBD. Tampoco se pueden utilizar dentro de applets al poseer código nativo.</p> </li> <li><strong>JDBC-Net pure Java driver</strong> (tipo 3): Estos controladores están escritos en Java y se encargan de convertir las llamadas JDBC a un protocolo independiente de la base de datos y en la aplicación servidora utilizan las funciones nativas del sistema de gestión de base de datos mediante el uso de una biblioteca JDBC en el servidor. La ventaja de esta opción es la portabilidad.</li> <li><strong>JDBC de Java cliente</strong> (tipo 4): Estos controladores están escritos en Java y se encargan de convertir las llamadas JDBC a un protocolo independiente de la base de datos y en la aplicación servidora utilizan las funciones nativas del sistema de gestión de base de datos sin necesidad de bibliotecas. La ventaja de esta opción es la portabilidad. Son como los drivers de tipo 3 pero sin la figura del intermediario y tampoco requieren ninguna configuración en la máquina cliente. Los drivers de tipo 4 se pueden utilizar para servidores Web de tamaño pequeño y medio, así como para intranets.</li> </ul> <h3 id="instalacion-controlador">Instalación controlador<a class="headerlink" href="#instalacion-controlador" title="Permanent link">¶</a></h3> <p>Consulta en el taller <a href="UD10_T02_Conectores_ES.html">UD10_T02_Conectores_ES</a> indicaciones sobre como instalar el controlador que necesites según tu IDE, sistema operativo y gestor de BBDD.</p> <div class="admonition info"> <p class="admonition-title">Base de datos de pruebas <code>starwars</code></p> <p>Todo el código fuente que veras a continuación se basa en el taller <a href="UD10_T03_AWS_IntelliJ_ES.html">UD10_T03_AWS_IntelliJ_ES</a>, que crea la BBDD <a href="https://github.com/miguelmarti/FreakDataBases/blob/main/StarWars.sql">"<em>StarWars</em>"</a> en un servidor <code>MariaDB</code> alojado en la nube de <code>Amazon</code>. Para replicar las pruebas necesitaras la dirección de tu instáncia de BBDD (algo parecido a <em>databasedmp.cipxbdkxiaqy.us-east-1.rds.amazonaws.com</em>), el puerto (por defecto <em>3306</em>), el usuario (<em>admin</em>) y la contraseña (<em>123456Ab$</em>). Asegurate de haber completado primero el taller para poder probar el código.</p> <p>Aquí te dejo el diagrama de la BD. Deberías familiarizarte con él antes de seguir.</p> <p><img alt="Diagrama de la BBDD" src="assets/Diagram1.png" width="1000"/></p> </div> <h3 id="carga-del-controlador-jdbc-y-conexion-con-la-bd">Carga del controlador JDBC y conexión con la BD<a class="headerlink" href="#carga-del-controlador-jdbc-y-conexion-con-la-bd" title="Permanent link">¶</a></h3> <p>El primer paso para conectarnos a una base de datos mediante JDBC es cargar el controlador apropiado. Estos controladores se distribuyen en un archivo <code>.jar</code> que provee el fabricante del SGBD y deben estar accesibles por la aplicación.</p> <p>Para cargar el controlador (MySQL) se usan las siguientes sentencias:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._02_JDBC</span><span class="p">;</span>
</span><span id="__span-0-2">
</span><span id="__span-0-3"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
</span><span id="__span-0-4"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.DriverManager</span><span class="p">;</span>
</span><span id="__span-0-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UD10_01_ConectarMySQL</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-8"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-9"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-10"><span class="w">            </span><span class="c1">// Dependiendo de a qué tipo de SGBD queramos conectar cargaremos un controlador u otro</span>
</span><span id="__span-0-11"><span class="w">            </span><span class="c1">// Intentar cargar el driver de MySQL</span>
</span><span id="__span-0-12"><span class="w">            </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="s">"com.mysql.cj.jdbc.Driver"</span><span class="p">);</span>
</span><span id="__span-0-13"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Cargado "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span>
</span><span id="__span-0-14">
</span><span id="__span-0-15"><span class="w">            </span><span class="c1">//Definir la url de conexión y los parámetros de usuario y contraseña</span>
</span><span id="__span-0-16"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"jdbc:mysql://databasedmp.cipxbdkxiaqy.us-east-1.rds.amazonaws.com:3306/starwars"</span><span class="p">;</span>
</span><span id="__span-0-17"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"admin"</span><span class="p">;</span>
</span><span id="__span-0-18"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"123456Ab$"</span><span class="p">;</span>
</span><span id="__span-0-19"><span class="w">            </span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">);</span>
</span><span id="__span-0-20">
</span><span id="__span-0-21"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Conexión completada"</span><span class="p">);</span>
</span><span id="__span-0-22"><span class="w">            </span><span class="c1">//cerrar la conexión</span>
</span><span id="__span-0-23"><span class="w">            </span><span class="n">con</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span><span id="__span-0-24"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="n">cnfe</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-25"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">cnfe</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-0-26"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-27"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"ERROR al conectar: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-0-28"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-0-29"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-30"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <p>Observamos las siguientes cuestiones:</p> <ul> <li>Como ya hemos comentado alguna vez, la sentencia <code>Class.forName()</code> no sería necesaria en muchas aplicaciones. Pero nos asegura que hemos cargado el driver, y por tanto el <code>DriverManager</code> la sabrá manejar</li> <li>El <code>DriverManager</code> es capaz de encontrar el driver adecuado a través de la url proporcionada (sobre todo si el driver está cargado en memoria), y es quien nos proporciona el objeto <code>Connection</code> por medio del método <code>getConnection()</code>. Hay otra manera de obtener el <code>Connection</code> por medio del objeto <code>Driver</code>, como veremos más adelante, pero también será pasando indirectamente por <code>DriverManager</code>.</li> <li>Si no se encuentra la clase del driver (por no tenerlo en las librerías del proyecto, o haber escrito mal su nombre) se producirá la excepción <code>ClassNotFoundException</code>. Es conveniente tratarla con <code>try ... catch</code>.</li> <li>Si no se puede establecer la conexión por alguna razón se producirá la excepción <code>SQLException</code>. Al igual que en el caso anterior, es conveniente tratarla con <code>try ... catch</code>.</li> <li>El objeto <code>Connection</code> mantendrá una conexión con la Base de Datos desde el momento de la creación hasta el momento de cerrarla con <code>close()</code>. Es muy importante cerrar la conexión, no sólo para liberar la memoria de nuestro ordenador (que al cerrar la aplicación liberaría), sino sobre todo para cerrar la sesión abierta en el Servidor de Bases de Datos.</li> </ul> <h4 id="conexion-alternativa-mediante-driver">Conexión alternativa mediante <code>Driver</code><a class="headerlink" href="#conexion-alternativa-mediante-driver" title="Permanent link">¶</a></h4> <p>Una manera de conectar alternativa a las anteriores es utilizando el objeto <code>Driver</code>. La clase <code>java.sql.Driver</code> pertenece a la <strong>API JDBC</strong>, pero no es instanciable, y tan sólo es una interfaz, para que las clases <code>Driver</code> de los contenedores hereden de ella e implementen la manera exacta de acceder al SGBD correspondiente. Como no es instanciable (no podemos hacer <code>new Driver()</code>) la manera de crearlo es a través del método <code>getDriver()</code> del <code>DriverManager</code>, que seleccionará el driver adecuado a partir de la url. Ya sólo quedarán definir algunas propiedades, como el usuario y la contraseña, y obtener el <code>Connection</code> por medio del método <code>connect()</code></p> <p>La manera de conectar a través de un objeto <code>Driver</code> es más larga, pero más completa ya que se podrían especificar más cosas. Y quizás ayude a entender el montaje de los controladores de los diferentes SGBD en Java.</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._02_JDBC</span><span class="p">;</span>
</span><span id="__span-1-2">
</span><span id="__span-1-3"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
</span><span id="__span-1-4"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Driver</span><span class="p">;</span>
</span><span id="__span-1-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.DriverManager</span><span class="p">;</span>
</span><span id="__span-1-6"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
</span><span id="__span-1-7"><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Properties</span><span class="p">;</span>
</span><span id="__span-1-8">
</span><span id="__span-1-9"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UD10_02_ConectarMySQLDriver</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-10"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-11"><span class="w">        </span><span class="c1">//Definir la url de conexión y los parámetros de usuario y contraseña</span>
</span><span id="__span-1-12"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"jdbc:mysql://databasedmp.cipxbdkxiaqy.us-east-1.rds.amazonaws.com:3306/starwars"</span><span class="p">;</span>
</span><span id="__span-1-13"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"admin"</span><span class="p">;</span>
</span><span id="__span-1-14"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"123456Ab$"</span><span class="p">;</span>
</span><span id="__span-1-15">
</span><span id="__span-1-16"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-17"><span class="w">            </span><span class="n">Driver</span><span class="w"> </span><span class="n">driver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DriverManager</span><span class="p">.</span><span class="na">getDriver</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
</span><span id="__span-1-18"><span class="w">            </span><span class="c1">//Establecer las propiedades de la conexión</span>
</span><span id="__span-1-19"><span class="w">            </span><span class="n">Properties</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Properties</span><span class="p">();</span>
</span><span id="__span-1-20"><span class="w">            </span><span class="n">properties</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="s">"user"</span><span class="p">,</span><span class="w"> </span><span class="n">username</span><span class="p">);</span>
</span><span id="__span-1-21"><span class="w">            </span><span class="n">properties</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="s">"password"</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">);</span>
</span><span id="__span-1-22"><span class="w">            </span><span class="c1">//Conectar</span>
</span><span id="__span-1-23"><span class="w">            </span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">driver</span><span class="p">.</span><span class="na">connect</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="n">properties</span><span class="p">);</span>
</span><span id="__span-1-24"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Conexión completada a través de Driver"</span><span class="p">);</span>
</span><span id="__span-1-25"><span class="w">            </span><span class="c1">//Cerrar la conexión</span>
</span><span id="__span-1-26"><span class="w">            </span><span class="n">con</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span><span id="__span-1-27"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-28"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"ERROR al conectar: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-1-29"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-1-30"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-31"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <h2 id="patrones-de-diseno-aplicables">Patrones de diseño aplicables<a class="headerlink" href="#patrones-de-diseno-aplicables" title="Permanent link">¶</a></h2> <h3 id="patron-singleton">Patrón <code>Singleton</code><a class="headerlink" href="#patron-singleton" title="Permanent link">¶</a></h3> <p>El patrón <code>Singleton</code> es un patrón de diseño que asegura que una clase tenga <strong>una única instancia</strong> durante toda la ejecución del programa, y proporciona un <strong>punto de acceso global</strong> a esa instancia. Esto es especialmente útil cuando queremos controlar el acceso a recursos compartidos, como una conexión a una base de datos.</p> <p><strong>¿Por qué usar <code>Singleton</code> en el acceso a bases de datos?</strong></p> <p>Cuando trabajamos con bases de datos relacionales, es común que necesitemos una <strong>única conexión</strong> o un <strong>pool de conexiones</strong> para interactuar con la base de datos. Si no controlamos cómo se crean estas conexiones, podríamos terminar con múltiples instancias de conexiones abiertas, lo que puede llevar a:</p> <ol> <li><strong>Consumo excesivo de recursos</strong>: Cada conexión consume memoria y recursos del sistema.</li> <li><strong>Problemas de consistencia</strong>: Si hay múltiples conexiones, podríamos tener inconsistencias en los datos.</li> <li><strong>Dificultad para gestionar</strong>: Sería complicado cerrar y controlar todas las conexiones abiertas.</li> </ol> <p>Vamos a implementar una clase <code>DatabaseConnection</code> que siga el patrón Singleton. Esta clase se encargará de gestionar la conexión a la base de datos.</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._01_Singleton</span><span class="p">;</span>
</span><span id="__span-2-2">
</span><span id="__span-2-3"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
</span><span id="__span-2-4"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.DriverManager</span><span class="p">;</span>
</span><span id="__span-2-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
</span><span id="__span-2-6">
</span><span id="__span-2-7"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DatabaseConnection</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-8">
</span><span id="__span-2-9"><span class="w">    </span><span class="c1">// 1. Declaramos una instancia estática y privada de la clase</span>
</span><span id="__span-2-10"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">DatabaseConnection</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span>
</span><span id="__span-2-11"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Connection</span><span class="w"> </span><span class="n">connection</span><span class="p">;</span>
</span><span id="__span-2-12">
</span><span id="__span-2-13"><span class="w">    </span><span class="c1">// 2. Hacemos el constructor privado para evitar que se creen instancias desde fuera</span>
</span><span id="__span-2-14"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="nf">DatabaseConnection</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-15"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-16"><span class="w">            </span><span class="c1">// Establecemos la conexión a la base de datos</span>
</span><span id="__span-2-17"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"jdbc:mysql://databasedmp.cipxbdkxiaqy.us-east-1.rds.amazonaws.com:3306/starwars"</span><span class="p">;</span>
</span><span id="__span-2-18"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"admin"</span><span class="p">;</span>
</span><span id="__span-2-19"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"123456Ab$"</span><span class="p">;</span>
</span><span id="__span-2-20"><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">);</span>
</span><span id="__span-2-21"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Conexión a la base de datos establecida."</span><span class="p">);</span>
</span><span id="__span-2-22"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-23"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Error al conectar a la base de datos: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-2-24"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-2-25"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-26">
</span><span id="__span-2-27"><span class="w">    </span><span class="c1">// 3. Método estático para obtener la instancia única (Singleton)</span>
</span><span id="__span-2-28"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">DatabaseConnection</span><span class="w"> </span><span class="nf">getInstance</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-29"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">instance</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-30"><span class="w">            </span><span class="n">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DatabaseConnection</span><span class="p">();</span>
</span><span id="__span-2-31"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-2-32"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span>
</span><span id="__span-2-33"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-34">
</span><span id="__span-2-35"><span class="w">    </span><span class="c1">// 4. Método para obtener la conexión</span>
</span><span id="__span-2-36"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Connection</span><span class="w"> </span><span class="nf">getConnection</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-37"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">connection</span><span class="p">;</span>
</span><span id="__span-2-38"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-39">
</span><span id="__span-2-40"><span class="w">    </span><span class="c1">// 5. Método para cerrar la conexión (opcional)</span>
</span><span id="__span-2-41"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">closeConnection</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-42"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">connection</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-43"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-44"><span class="w">                </span><span class="n">connection</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span><span id="__span-2-45"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Conexión cerrada."</span><span class="p">);</span>
</span><span id="__span-2-46"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-47"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Error al cerrar la conexión: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-2-48"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-2-49"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-2-50"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-51"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <p><strong>Explicación paso a paso</strong></p> <ol> <li><strong>Instancia única</strong>: La variable <code>instance</code> es estática y privada, lo que significa que pertenece a la clase y no puede ser accedida directamente desde fuera. Esto asegura que solo exista una instancia de <code>DatabaseConnection</code>.</li> <li><strong>Constructor privado</strong>: Al hacer el constructor privado, evitamos que otras clases puedan crear instancias de <code>DatabaseConnection</code> usando <code>new DatabaseConnection()</code>. Esto garantiza que la única forma de obtener la instancia sea a través del método <code>getInstance()</code>.</li> <li><strong>Método <code>getInstance()</code></strong>: Este método es estático y se encarga de crear la instancia única si no existe, o devolver la existente si ya fue creada. Esto asegura que siempre trabajemos con la misma conexión.</li> <li><strong>Conexión a la base de datos</strong>: La conexión se establece en el constructor privado, y podemos acceder a ella a través del método <code>getConnection()</code>.</li> <li><strong>Cerrar la conexión</strong>: Aunque no es estrictamente necesario, es buena práctica proporcionar un método para cerrar la conexión cuando ya no la necesitemos.</li> </ol> <p><strong>¿Cómo usamos esta clase?</strong></p> <p>Aquí tienes un ejemplo de cómo usar la clase <code>DatabaseConnection</code> en tu aplicación:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._01_Singleton</span><span class="p">;</span>
</span><span id="__span-3-2">
</span><span id="__span-3-3"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
</span><span id="__span-3-4">
</span><span id="__span-3-5"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DatabaseConnectionTest</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-6"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Main</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-7"><span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-8"><span class="w">            </span><span class="c1">// Obtenemos la instancia única de DatabaseConnection</span>
</span><span id="__span-3-9"><span class="w">            </span><span class="n">DatabaseConnection</span><span class="w"> </span><span class="n">dbConnection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DatabaseConnection</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
</span><span id="__span-3-10">
</span><span id="__span-3-11"><span class="w">            </span><span class="c1">// Usamos la conexión para interactuar con la base de datos</span>
</span><span id="__span-3-12"><span class="w">            </span><span class="n">Connection</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbConnection</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-3-13"><span class="w">            </span><span class="c1">// Aquí podríamos ejecutar consultas SQL, por ejemplo:</span>
</span><span id="__span-3-14"><span class="w">            </span><span class="c1">// Statement statement = connection.createStatement();</span>
</span><span id="__span-3-15"><span class="w">            </span><span class="c1">// ResultSet resultSet = statement.executeQuery("SELECT * FROM usuarios");</span>
</span><span id="__span-3-16">
</span><span id="__span-3-17"><span class="w">            </span><span class="c1">// Cerramos la conexión cuando ya no la necesitemos</span>
</span><span id="__span-3-18"><span class="w">            </span><span class="n">dbConnection</span><span class="p">.</span><span class="na">closeConnection</span><span class="p">();</span>
</span><span id="__span-3-19"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-3-20"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-21"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <h3 id="patron-pool-object-database-pool-connection-dbpc">Patrón <code>Pool Object</code> (DataBase Pool Connection <code>DBPC</code>)<a class="headerlink" href="#patron-pool-object-database-pool-connection-dbpc" title="Permanent link">¶</a></h3> <p>El patrón Pool de Objetos es un patrón de diseño que tiene como objetivo <strong>reutilizar objetos</strong> que son costosos de crear, como conexiones a bases de datos, hilos, o sockets. En lugar de crear y destruir estos objetos repetidamente, el patrón mantiene un <strong>conjunto de objetos ya creados</strong> (un "pool") que pueden ser prestados y devueltos cuando ya no se necesiten.</p> <p><strong>¿Por qué usar un Pool de Objetos en el acceso a bases de datos?</strong></p> <p>Cuando trabajamos con bases de datos, establecer una nueva conexión es una operación costosa en términos de tiempo y recursos. Si abrimos y cerramos conexiones constantemente, el rendimiento de la aplicación se verá afectado. Aquí es donde entra en juego el <strong>Database Connection Pooling (DBCP)</strong>.</p> <p>Un <strong>Database Connection Pool</strong> es una implementación específica del patrón Pool de Objetos que se encarga de gestionar múltiples conexiones a la base de datos. En lugar de crear una nueva conexión cada vez que se necesita, el pool:</p> <ol> <li><strong>Mantiene un conjunto de conexiones abiertas</strong> y listas para ser usadas.</li> <li><strong>Presta una conexión</strong> cuando un componente de la aplicación la solicita.</li> <li><strong>Recupera la conexión</strong> cuando el componente termina de usarla, permitiendo que sea reutilizada por otros componentes.</li> </ol> <p><strong>¿Qué es HikariCP?</strong></p> <p><strong>HikariCP</strong> es una librería de conexión a bases de datos que implementa un <strong>Database Connection Pool</strong>. Es conocida por ser extremadamente rápida, ligera y eficiente en comparación con otras soluciones como Apache DBCP o C3P0. HikariCP se ha convertido en el estándar de facto para aplicaciones Java que requieren alta concurrencia y rendimiento.</p> <p>Además en IntelliJ con maven es muy sencillo, ya que solo debemos agregar esta dependencia al <code>pom.xml</code>:</p> <div class="language-xml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><span class="cm">&lt;!-- HikariCP --&gt;</span>
</span><span id="__span-4-2"><span class="cm">&lt;!-- https://mvnrepository.com/artifact/com.zaxxer/HikariCP --&gt;</span>
</span><span id="__span-4-3"><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-4-4"><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>com.zaxxer<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-4-5"><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>HikariCP<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-4-6"><span class="w">    </span><span class="nt">&lt;version&gt;</span>6.2.1<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-4-7"><span class="nt">&lt;/dependency&gt;</span>
</span></code></pre></div></td></tr></table></div> <p>Ventajas de usar un pool de conexiones:</p> <ul> <li><strong>Mejora del rendimiento</strong>: Al reutilizar conexiones existentes, se evita el costo de crear y cerrar conexiones repetidamente.</li> <li><strong>Control de recursos</strong>: El pool limita el número máximo de conexiones, evitando que la base de datos se sature.</li> <li><strong>Escalabilidad</strong>: Permite que múltiples hilos o componentes de la aplicación accedan a la base de datos de manera concurrente sin problemas.</li> <li><strong>Manejo de errores</strong>: El pool puede manejar conexiones caídas o inválidas, reemplazándolas automáticamente.</li> </ul> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_PoolObject</span><span class="p">;</span>
</span><span id="__span-5-2">
</span><span id="__span-5-3"><span class="kn">import</span><span class="w"> </span><span class="nn">com.zaxxer.hikari.HikariConfig</span><span class="p">;</span>
</span><span id="__span-5-4"><span class="kn">import</span><span class="w"> </span><span class="nn">com.zaxxer.hikari.HikariDataSource</span><span class="p">;</span>
</span><span id="__span-5-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
</span><span id="__span-5-6"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
</span><span id="__span-5-7">
</span><span id="__span-5-8"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">HikariCPSingleton</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-9">
</span><span id="__span-5-10"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">HikariDataSource</span><span class="w"> </span><span class="n">dataSource</span><span class="p">;</span>
</span><span id="__span-5-11">
</span><span id="__span-5-12"><span class="w">    </span><span class="c1">// Configuración del pool de conexiones</span>
</span><span id="__span-5-13"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-14"><span class="w">        </span><span class="n">HikariConfig</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HikariConfig</span><span class="p">();</span>
</span><span id="__span-5-15"><span class="w">        </span><span class="n">config</span><span class="p">.</span><span class="na">setJdbcUrl</span><span class="p">(</span><span class="s">"jdbc:mariadb://databasedmp.cipxbdkxiaqy.us-east-1.rds.amazonaws.com:3306/starwars"</span><span class="p">);</span><span class="w"> </span><span class="c1">// URL de la base de datos</span>
</span><span id="__span-5-16"><span class="w">        </span><span class="n">config</span><span class="p">.</span><span class="na">setUsername</span><span class="p">(</span><span class="s">"admin"</span><span class="p">);</span><span class="w"> </span><span class="c1">// Usuario de la base de datos</span>
</span><span id="__span-5-17"><span class="w">        </span><span class="n">config</span><span class="p">.</span><span class="na">setPassword</span><span class="p">(</span><span class="s">"123456Ab$"</span><span class="p">);</span><span class="w"> </span><span class="c1">// Contraseña de la base de datos</span>
</span><span id="__span-5-18"><span class="w">        </span><span class="n">config</span><span class="p">.</span><span class="na">setMaximumPoolSize</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// Número máximo de conexiones en el pool</span>
</span><span id="__span-5-19"><span class="w">        </span><span class="n">config</span><span class="p">.</span><span class="na">setMinimumIdle</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c1">// Número mínimo de conexiones inactivas en el pool</span>
</span><span id="__span-5-20"><span class="w">        </span><span class="n">config</span><span class="p">.</span><span class="na">setIdleTimeout</span><span class="p">(</span><span class="mi">30000</span><span class="p">);</span><span class="w"> </span><span class="c1">// Tiempo de espera para conexiones inactivas (en milisegundos)</span>
</span><span id="__span-5-21"><span class="w">        </span><span class="n">config</span><span class="p">.</span><span class="na">setMaxLifetime</span><span class="p">(</span><span class="mi">1800000</span><span class="p">);</span><span class="w"> </span><span class="c1">// Tiempo máximo de vida de una conexión (en milisegundos)</span>
</span><span id="__span-5-22"><span class="w">        </span><span class="n">config</span><span class="p">.</span><span class="na">setConnectionTimeout</span><span class="p">(</span><span class="mi">30000</span><span class="p">);</span><span class="w"> </span><span class="c1">// Tiempo de espera para obtener una conexión (en milisegundos)</span>
</span><span id="__span-5-23">
</span><span id="__span-5-24"><span class="w">        </span><span class="n">dataSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HikariDataSource</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span id="__span-5-25"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-26">
</span><span id="__span-5-27"><span class="w">    </span><span class="c1">// Método para obtener una conexión del pool</span>
</span><span id="__span-5-28"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Connection</span><span class="w"> </span><span class="nf">getConnection</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-29"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dataSource</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-5-30"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-31">
</span><span id="__span-5-32"><span class="w">    </span><span class="c1">// Método para cerrar el pool de conexiones (opcional)</span>
</span><span id="__span-5-33"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">closeDataSource</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-34"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dataSource</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-35"><span class="w">            </span><span class="n">dataSource</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span><span id="__span-5-36"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-5-37"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-38"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <p><strong>¿Cómo usamos esta clase?</strong></p> <p>Aquí tienes un ejemplo de cómo usar la clase <code>HikariCPSingleton</code> en tu aplicación:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_PoolObject</span><span class="p">;</span>
</span><span id="__span-6-2">
</span><span id="__span-6-3"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
</span><span id="__span-6-4"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
</span><span id="__span-6-5">
</span><span id="__span-6-6"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">HikariCPSingletonTest</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-7">
</span><span id="__span-6-8"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Connection</span><span class="w"> </span><span class="n">connection</span><span class="p">;</span>
</span><span id="__span-6-9">
</span><span id="__span-6-10"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-11"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-12"><span class="w">            </span><span class="n">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-6-13"><span class="w">            </span><span class="c1">// Hacemos algo con la conexión</span>
</span><span id="__span-6-14"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-15"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"ERROR al conectar: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-6-16"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-6-17"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-18"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition info"> <p class="admonition-title">Recomendación</p> <p>Este último Patrón <code>Pool Object</code> será el que usaremos para el resto de ejemplos de la unidad, y el que te recomiendo que uses. Si no te convence mi opinión, puedes ver el vídeo de <a href="https://www.youtube.com/@makigas">makigas</a> que tienes más abajo.</p> </div> <h3 id="patron-dao">Patrón <code>DAO</code><a class="headerlink" href="#patron-dao" title="Permanent link">¶</a></h3> <p>Proporciona una abstracción para las operaciones CRUD (Create, Read, Update, Delete) con la base de datos. Este patrón separa la lógica de negocio de la lógica de acceso a datos, facilitando el mantenimiento y la escalabilidad del código.</p> <p>El patrón DAO se utiliza para encapsular todo el acceso a la base de datos en una clase separada. Esto permite que la lógica de negocio interactúe con la base de datos a través de métodos definidos en el DAO, sin preocuparse por los detalles de la implementación de la base de datos.</p> <div class="admonition example"> <p class="admonition-title">Ejemplo para una clase <code>Film</code> sencilla</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._03_DAO</span><span class="p">;</span>
</span><span id="__span-7-2">
</span><span id="__span-7-3"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Film</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-4"><span class="w"> </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-7-5"><span class="w"> </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">episode</span><span class="p">;</span>
</span><span id="__span-7-6"><span class="w"> </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>
</span><span id="__span-7-7">
</span><span id="__span-7-8"><span class="w"> </span><span class="c1">// Getters y setters</span>
</span><span id="__span-7-9"><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getId</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-10"><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-7-11"><span class="w"> </span><span class="p">}</span>
</span><span id="__span-7-12">
</span><span id="__span-7-13"><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setId</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-14"><span class="w">     </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-7-15"><span class="w"> </span><span class="p">}</span>
</span><span id="__span-7-16">
</span><span id="__span-7-17"><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getEpisode</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-18"><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">episode</span><span class="p">;</span>
</span><span id="__span-7-19"><span class="w"> </span><span class="p">}</span>
</span><span id="__span-7-20">
</span><span id="__span-7-21"><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setEpisode</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">episode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-22"><span class="w">     </span><span class="k">this</span><span class="p">.</span><span class="na">episode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">episode</span><span class="p">;</span>
</span><span id="__span-7-23"><span class="w"> </span><span class="p">}</span>
</span><span id="__span-7-24">
</span><span id="__span-7-25"><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getTitle</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-26"><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>
</span><span id="__span-7-27"><span class="w"> </span><span class="p">}</span>
</span><span id="__span-7-28">
</span><span id="__span-7-29"><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setTitle</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-30"><span class="w">     </span><span class="k">this</span><span class="p">.</span><span class="na">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>
</span><span id="__span-7-31"><span class="w"> </span><span class="p">}</span>
</span><span id="__span-7-32"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <p>La interfaz de <code>FilmDAO</code>:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_DAO</span><span class="p">;</span>
</span><span id="__span-8-2">
</span><span id="__span-8-3"><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">FilmDAO</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-4"><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">agregarFilm</span><span class="p">(</span><span class="n">Film</span><span class="w"> </span><span class="n">film</span><span class="p">);</span><span class="w">         </span><span class="c1">// Crear una nueva película</span>
</span><span id="__span-8-5"><span class="w">    </span><span class="n">Film</span><span class="w"> </span><span class="nf">obtenerFilm</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w">            </span><span class="c1">// Obtener una película por su ID</span>
</span><span id="__span-8-6"><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">actualizarFilm</span><span class="p">(</span><span class="n">Film</span><span class="w"> </span><span class="n">film</span><span class="p">);</span><span class="w">      </span><span class="c1">// Actualizar una película existente</span>
</span><span id="__span-8-7"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">eliminarFilm</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w">           </span><span class="c1">// Eliminar una película por su ID</span>
</span><span id="__span-8-8"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition question"> <p class="admonition-title">Reflexiona</p> <p>Dejo aquí una cuestión en el aire para que reflexiones, si todas las entidades van a usar una Interfaz similar... que solución propones para definir una única Interfaz DAO que sirva para todas las entidades? (pista: Genéricos)</p> </div> <p>Y por último la implementación de la interfaz en <code>FilmDAOImplementado</code>:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._03_DAO</span><span class="p">;</span>
</span><span id="__span-9-2">
</span><span id="__span-9-3"><span class="kn">import</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_PoolObject.HikariCPSingleton</span><span class="p">;</span>
</span><span id="__span-9-4">
</span><span id="__span-9-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
</span><span id="__span-9-6"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
</span><span id="__span-9-7"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.ResultSet</span><span class="p">;</span>
</span><span id="__span-9-8"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
</span><span id="__span-9-9">
</span><span id="__span-9-10"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">FilmDAOImplementado</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">FilmDAO</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-11">
</span><span id="__span-9-12"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Connection</span><span class="w"> </span><span class="n">connection</span><span class="p">;</span>
</span><span id="__span-9-13">
</span><span id="__span-9-14"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">FilmDAOImplementado</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-15"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-16"><span class="w">            </span><span class="n">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-9-17"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-18"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"ERROR al conectar: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-9-19"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-9-20"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-21">
</span><span id="__span-9-22"><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-9-23"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">agregarFilm</span><span class="p">(</span><span class="n">Film</span><span class="w"> </span><span class="n">film</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-24"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-25"><span class="w">            </span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">connection</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="s">"INSERT INTO films (id, episode, title) VALUES (?,?,?)"</span><span class="p">);</span>
</span><span id="__span-9-26"><span class="w">            </span><span class="n">ps</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">film</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span>
</span><span id="__span-9-27"><span class="w">            </span><span class="n">ps</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">film</span><span class="p">.</span><span class="na">getEpisode</span><span class="p">());</span>
</span><span id="__span-9-28"><span class="w">            </span><span class="n">ps</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">film</span><span class="p">.</span><span class="na">getTitle</span><span class="p">());</span>
</span><span id="__span-9-29"><span class="w">            </span><span class="n">ps</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
</span><span id="__span-9-30"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-31"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
</span><span id="__span-9-32"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-9-33"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-34">
</span><span id="__span-9-35"><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-9-36"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Film</span><span class="w"> </span><span class="nf">obtenerFilm</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-37"><span class="w">        </span><span class="n">Film</span><span class="w"> </span><span class="n">film</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-9-38"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-39"><span class="w">            </span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">connection</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="s">"SELECT * FROM films WHERE id = ?"</span><span class="p">);</span>
</span><span id="__span-9-40"><span class="w">            </span><span class="n">ps</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
</span><span id="__span-9-41"><span class="w">            </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ps</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">();</span>
</span><span id="__span-9-42"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-43"><span class="w">                </span><span class="n">film</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Film</span><span class="p">();</span>
</span><span id="__span-9-44"><span class="w">                </span><span class="n">film</span><span class="p">.</span><span class="na">setId</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">"id"</span><span class="p">));</span>
</span><span id="__span-9-45"><span class="w">                </span><span class="n">film</span><span class="p">.</span><span class="na">setEpisode</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">"episode"</span><span class="p">));</span>
</span><span id="__span-9-46"><span class="w">                </span><span class="n">film</span><span class="p">.</span><span class="na">setTitle</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">"title"</span><span class="p">));</span>
</span><span id="__span-9-47"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-9-48"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-49"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
</span><span id="__span-9-50"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-9-51"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">film</span><span class="p">;</span>
</span><span id="__span-9-52"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-53">
</span><span id="__span-9-54"><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-9-55"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">actualizarFilm</span><span class="p">(</span><span class="n">Film</span><span class="w"> </span><span class="n">film</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-56"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-57"><span class="w">            </span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">connection</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="s">"UPDATE films SET episode = ?, title = ? WHERE id = ?"</span><span class="p">);</span>
</span><span id="__span-9-58"><span class="w">            </span><span class="n">ps</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">film</span><span class="p">.</span><span class="na">getEpisode</span><span class="p">());</span>
</span><span id="__span-9-59"><span class="w">            </span><span class="n">ps</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">film</span><span class="p">.</span><span class="na">getTitle</span><span class="p">());</span>
</span><span id="__span-9-60"><span class="w">            </span><span class="n">ps</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">film</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span>
</span><span id="__span-9-61"><span class="w">            </span><span class="n">ps</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
</span><span id="__span-9-62"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-63"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
</span><span id="__span-9-64"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-9-65"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-66">
</span><span id="__span-9-67"><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-9-68"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">eliminarFilm</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-69"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-70"><span class="w">            </span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">connection</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="s">"DELETE FROM films WHERE id = ?"</span><span class="p">);</span>
</span><span id="__span-9-71"><span class="w">            </span><span class="n">ps</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
</span><span id="__span-9-72"><span class="w">            </span><span class="n">ps</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
</span><span id="__span-9-73"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-74"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
</span><span id="__span-9-75"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-9-76"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-77"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> </div> <p>Entre las ventajas de usar el patrón encontramos:</p> <ul> <li><strong>Separación de responsabilidades</strong>: La lógica de acceso a datos se separa de la lógica de negocio.</li> <li><strong>Reutilización de código</strong>: Los métodos de acceso a datos pueden ser reutilizados por diferentes partes de la aplicación.</li> <li><strong>Facilidad de mantenimiento</strong>: Cambiar la implementación de la base de datos no afecta la lógica de negocio.</li> </ul> <p>Con la siguiente clase <code>TestFilmDAOImplementado.java</code> podemos probar los métodos implementados:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._03_DAO</span><span class="p">;</span>
</span><span id="__span-10-2">
</span><span id="__span-10-3"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">TestFilmDAOImplementado</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-4">
</span><span id="__span-10-5"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-6"><span class="w">        </span><span class="c1">// Crear una instancia de FilmDAOImplementado</span>
</span><span id="__span-10-7"><span class="w">        </span><span class="n">FilmDAOImplementado</span><span class="w"> </span><span class="n">filmDAO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FilmDAOImplementado</span><span class="p">();</span>
</span><span id="__span-10-8">
</span><span id="__span-10-9"><span class="w">        </span><span class="c1">// Crear un film ficticio para el episodio 7</span>
</span><span id="__span-10-10"><span class="w">        </span><span class="n">Film</span><span class="w"> </span><span class="n">film</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Film</span><span class="p">();</span>
</span><span id="__span-10-11"><span class="w">        </span><span class="n">film</span><span class="p">.</span><span class="na">setId</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span><span class="w"> </span><span class="c1">// Cambiamos el episodio a 7</span>
</span><span id="__span-10-12"><span class="w">        </span><span class="n">film</span><span class="p">.</span><span class="na">setEpisode</span><span class="p">(</span><span class="s">"VII"</span><span class="p">);</span>
</span><span id="__span-10-13"><span class="w">        </span><span class="n">film</span><span class="p">.</span><span class="na">setTitle</span><span class="p">(</span><span class="s">"The Force Awakens"</span><span class="p">);</span><span class="w"> </span><span class="c1">// Cambiamos el título</span>
</span><span id="__span-10-14">
</span><span id="__span-10-15"><span class="w">        </span><span class="c1">// 1. Insertar el film en la base de datos</span>
</span><span id="__span-10-16"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Insertando el film..."</span><span class="p">);</span>
</span><span id="__span-10-17"><span class="w">        </span><span class="n">filmDAO</span><span class="p">.</span><span class="na">agregarFilm</span><span class="p">(</span><span class="n">film</span><span class="p">);</span>
</span><span id="__span-10-18"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Film insertado: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">film</span><span class="p">.</span><span class="na">getTitle</span><span class="p">());</span>
</span><span id="__span-10-19">
</span><span id="__span-10-20"><span class="w">        </span><span class="c1">// 2. Recuperar el film recién insertado (asumiendo que el ID es 1)</span>
</span><span id="__span-10-21"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"\nRecuperando el film con ID 7..."</span><span class="p">);</span>
</span><span id="__span-10-22"><span class="w">        </span><span class="n">Film</span><span class="w"> </span><span class="n">filmRecuperado</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filmDAO</span><span class="p">.</span><span class="na">obtenerFilm</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
</span><span id="__span-10-23"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">filmRecuperado</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-24"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Film recuperado: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filmRecuperado</span><span class="p">.</span><span class="na">getTitle</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">" ("</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filmRecuperado</span><span class="p">.</span><span class="na">getEpisode</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">")"</span><span class="p">);</span>
</span><span id="__span-10-25"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-26"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"No se encontró el film con ID 7."</span><span class="p">);</span>
</span><span id="__span-10-27"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-10-28">
</span><span id="__span-10-29"><span class="w">        </span><span class="c1">// 3. Modificar el film recuperado</span>
</span><span id="__span-10-30"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">filmRecuperado</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-31"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"\nModificando el film..."</span><span class="p">);</span>
</span><span id="__span-10-32"><span class="w">            </span><span class="n">filmRecuperado</span><span class="p">.</span><span class="na">setEpisode</span><span class="p">(</span><span class="s">"Episode VII"</span><span class="p">);</span><span class="w"> </span><span class="c1">// Cambiamos el título para agregar más detalle</span>
</span><span id="__span-10-33"><span class="w">            </span><span class="n">filmDAO</span><span class="p">.</span><span class="na">actualizarFilm</span><span class="p">(</span><span class="n">filmRecuperado</span><span class="p">);</span>
</span><span id="__span-10-34"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Film modificado: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filmRecuperado</span><span class="p">.</span><span class="na">getTitle</span><span class="p">());</span>
</span><span id="__span-10-35">
</span><span id="__span-10-36"><span class="w">            </span><span class="c1">// Verificar la modificación</span>
</span><span id="__span-10-37"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"\nRecuperando el film modificado..."</span><span class="p">);</span>
</span><span id="__span-10-38"><span class="w">            </span><span class="n">Film</span><span class="w"> </span><span class="n">filmModificado</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filmDAO</span><span class="p">.</span><span class="na">obtenerFilm</span><span class="p">(</span><span class="n">filmRecuperado</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span>
</span><span id="__span-10-39"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">filmModificado</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-40"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Film modificado recuperado: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filmModificado</span><span class="p">.</span><span class="na">getTitle</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">" ("</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filmModificado</span><span class="p">.</span><span class="na">getEpisode</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">")"</span><span class="p">);</span>
</span><span id="__span-10-41"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-42"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"No se encontró el film modificado."</span><span class="p">);</span>
</span><span id="__span-10-43"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-10-44"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-10-45">
</span><span id="__span-10-46"><span class="w">        </span><span class="c1">// 4. Eliminar el film</span>
</span><span id="__span-10-47"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">filmRecuperado</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-48"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"\nEliminando el film con ID "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filmRecuperado</span><span class="p">.</span><span class="na">getId</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"..."</span><span class="p">);</span>
</span><span id="__span-10-49"><span class="w">            </span><span class="n">filmDAO</span><span class="p">.</span><span class="na">eliminarFilm</span><span class="p">(</span><span class="n">filmRecuperado</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span>
</span><span id="__span-10-50"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Film eliminado."</span><span class="p">);</span>
</span><span id="__span-10-51">
</span><span id="__span-10-52"><span class="w">            </span><span class="c1">// Verificar la eliminación</span>
</span><span id="__span-10-53"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"\nIntentando recuperar el film eliminado..."</span><span class="p">);</span>
</span><span id="__span-10-54"><span class="w">            </span><span class="n">Film</span><span class="w"> </span><span class="n">filmEliminado</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filmDAO</span><span class="p">.</span><span class="na">obtenerFilm</span><span class="p">(</span><span class="n">filmRecuperado</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span>
</span><span id="__span-10-55"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">filmEliminado</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-56"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"El film fue eliminado correctamente."</span><span class="p">);</span>
</span><span id="__span-10-57"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-58"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"El film no fue eliminado."</span><span class="p">);</span>
</span><span id="__span-10-59"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-10-60"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-10-61"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-10-62"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <p>El resultado será:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><span class="n">Insertando</span><span class="w"> </span><span class="n">el</span><span class="w"> </span><span class="n">film</span><span class="p">...</span>
</span><span id="__span-11-2"><span class="n">Film</span><span class="w"> </span><span class="n">insertado</span><span class="p">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Force</span><span class="w"> </span><span class="n">Awakens</span>
</span><span id="__span-11-3">
</span><span id="__span-11-4"><span class="n">Recuperando</span><span class="w"> </span><span class="n">el</span><span class="w"> </span><span class="n">film</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="mf">7.</span><span class="p">..</span>
</span><span id="__span-11-5"><span class="n">Film</span><span class="w"> </span><span class="n">recuperado</span><span class="p">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Force</span><span class="w"> </span><span class="nf">Awakens</span><span class="w"> </span><span class="p">(</span><span class="n">VII</span><span class="p">)</span>
</span><span id="__span-11-6">
</span><span id="__span-11-7"><span class="n">Modificando</span><span class="w"> </span><span class="n">el</span><span class="w"> </span><span class="n">film</span><span class="p">...</span>
</span><span id="__span-11-8"><span class="n">Film</span><span class="w"> </span><span class="n">modificado</span><span class="p">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Force</span><span class="w"> </span><span class="n">Awakens</span>
</span><span id="__span-11-9">
</span><span id="__span-11-10"><span class="n">Recuperando</span><span class="w"> </span><span class="n">el</span><span class="w"> </span><span class="n">film</span><span class="w"> </span><span class="n">modificado</span><span class="p">...</span>
</span><span id="__span-11-11"><span class="n">Film</span><span class="w"> </span><span class="n">modificado</span><span class="w"> </span><span class="n">recuperado</span><span class="p">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Force</span><span class="w"> </span><span class="nf">Awakens</span><span class="w"> </span><span class="p">(</span><span class="n">Episode</span><span class="w"> </span><span class="n">VII</span><span class="p">)</span>
</span><span id="__span-11-12">
</span><span id="__span-11-13"><span class="n">Eliminando</span><span class="w"> </span><span class="n">el</span><span class="w"> </span><span class="n">film</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="mf">7.</span><span class="p">..</span>
</span><span id="__span-11-14"><span class="n">Film</span><span class="w"> </span><span class="n">eliminado</span><span class="p">.</span>
</span><span id="__span-11-15">
</span><span id="__span-11-16"><span class="n">Intentando</span><span class="w"> </span><span class="n">recuperar</span><span class="w"> </span><span class="n">el</span><span class="w"> </span><span class="n">film</span><span class="w"> </span><span class="n">eliminado</span><span class="p">...</span>
</span><span id="__span-11-17"><span class="n">El</span><span class="w"> </span><span class="n">film</span><span class="w"> </span><span class="n">fue</span><span class="w"> </span><span class="n">eliminado</span><span class="w"> </span><span class="n">correctamente</span><span class="p">.</span>
</span></code></pre></div></td></tr></table></div> <h2 id="acceso-a-bbdd">Acceso a BBDD<a class="headerlink" href="#acceso-a-bbdd" title="Permanent link">¶</a></h2> <p>En este apartado se ofrece una introducción a los aspectos fundamentales del acceso a bases de datos mediante código Java. En los siguientes apartados se explicarán algunos aspectos en mayor detalle, sobre todo los relacionados con las clases <code>Statement</code> y <code>ResultSet</code>.</p> <h3 id="cargar-el-driver">Cargar el <code>Driver</code><a class="headerlink" href="#cargar-el-driver" title="Permanent link">¶</a></h3> <p>En un proyecto Java que realice conexiones a bases de datos es necesario, antes que nada, utilizar <code>Class.forname(…)</code> para cargar dinámicamente el <code>Driver</code> que vamos a utilizar. Esto solo es necesario hacerlo una vez en nuestro programa. Puede lanzar excepciones por lo que es necesario utilizar un bloque <code>try-catch</code>.</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-2"><span class="w">    </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="s">"com.mysql.cj.jdbc.Driver"</span><span class="p">);</span>
</span><span id="__span-12-3"><span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Cargado "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span>
</span><span id="__span-12-4"><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-5"><span class="w">    </span><span class="c1">// manejamos el error</span>
</span><span id="__span-12-6"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <p>Hay que tener en cuenta que las clases y métodos utilizados para conectarse a una base de datos (explicados más adelante) funcionan con todos los drivers disponibles para Java (JDBC es solo uno, hay muchos más). Esto es posible ya que el estándar de Java solo los define como interfaces (<em>interface</em>) y cada librería driver los implementa (define las clases y su código). Por ello es necesario utilizar <code>Class.forName(…)</code> para indicarle a Java qué driver vamos a utilizar.</p> <p>Este nivel de asbtracción facilita el desarrollo de proyectos ya que si necesitáramos utilizar otro sistema de base de datos (que no fuera <em>MySQL</em>) solo necesitaríamos cambiar la línea de código que carga el driver y poco más. Si cada sistema de base de datos necesitara que utilizáramos distintas clases y métodos todo sería mucho más complicado.</p> <p>Las cuatro clases fundamentales que toda aplicación Java necesita para conectarse a una base de datos y ejecutar sentencias son: <strong><code>DriverManager</code></strong>, <strong><code>Connection</code></strong>, <strong><code>Statement</code></strong> y <strong><code>ResultSet</code></strong>. </p> <p><img alt="img" src="assets/clases_conexiones.png" width="600"/></p> <p><img alt="jdbc proceso" src="assets/jdbc_proceso.png" style="zoom: 33%;"/></p> <h3 id="clase-drivermanager">Clase <code>DriverManager</code><a class="headerlink" href="#clase-drivermanager" title="Permanent link">¶</a></h3> <p><strong>Paso 1: Establecer conexión con la BBDD</strong></p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><span class="cm">/* Para MySQL:</span>
</span><span id="__span-13-2"><span class="cm">     jdbc  --&gt; driver</span>
</span><span id="__span-13-3"><span class="cm">     mysql --&gt; protocolo driver</span>
</span><span id="__span-13-4"><span class="cm">     localhost --&gt; dirección del servidor</span>
</span><span id="__span-13-5"><span class="cm">     3306 --&gt; puerto</span>
</span><span id="__span-13-6"><span class="cm">     gestionPedidos --&gt; nombre de la BD</span>
</span><span id="__span-13-7"><span class="cm">*/</span>
</span><span id="__span-13-8"><span class="nl">jdbc</span><span class="p">:</span><span class="n">mysql</span><span class="p">:</span><span class="n">localhost</span><span class="p">:</span><span class="mi">3306</span><span class="o">/</span><span class="n">gestionPedidos</span>
</span><span id="__span-13-9">
</span><span id="__span-13-10"><span class="cm">/* Para SQL Server:</span>
</span><span id="__span-13-11"><span class="cm">     jdbc  --&gt; driver</span>
</span><span id="__span-13-12"><span class="cm">     odbc --&gt; protocolo driver</span>
</span><span id="__span-13-13"><span class="cm">     DSN_gestionPedidos --&gt; Nombre de la BD</span>
</span><span id="__span-13-14"><span class="cm">*/</span>
</span><span id="__span-13-15"><span class="nl">jdbc</span><span class="p">:</span><span class="n">odbc</span><span class="p">:</span><span class="n">DSN_gestionPedidos</span>
</span><span id="__span-13-16">
</span><span id="__span-13-17"><span class="cm">/* Para Oracle:</span>
</span><span id="__span-13-18"><span class="cm">     jdbc  --&gt; driver</span>
</span><span id="__span-13-19"><span class="cm">     oracle --&gt; protocolo driver</span>
</span><span id="__span-13-20"><span class="cm">     juan --&gt; nombre de usuario</span>
</span><span id="__span-13-21"><span class="cm">     @servidor --&gt; dirección del servidor</span>
</span><span id="__span-13-22"><span class="cm">     3306 --&gt; puerto</span>
</span><span id="__span-13-23"><span class="cm">     gestionPedidos --&gt; nombre de la BD</span>
</span><span id="__span-13-24"><span class="cm">*/</span>
</span><span id="__span-13-25"><span class="nl">jdbc</span><span class="p">:</span><span class="n">oracle</span><span class="p">:</span><span class="n">juan</span><span class="nd">@servidor</span><span class="p">:</span><span class="mi">3306</span><span class="p">:</span><span class="n">gestionPedidos</span>
</span></code></pre></div></td></tr></table></div> <p>Vamos a necesitar información adicional como son los datos de <em>usuario</em> y <em>contraseña</em>.</p> <p>La clase <code>java.sql.DriverManager</code> es la capa gestora del driver JDBC. Se encarga de manejar el Driver apropiado y <strong>permite crear conexiones con una base de datos</strong> mediante el método estático <code>getConnection()</code> que tiene dos variantes:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><span class="c1">//opcion 1</span>
</span><span id="__span-14-2"><span class="n">DriveManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">URL</span><span class="p">)</span>
</span><span id="__span-14-3">
</span><span id="__span-14-4"><span class="c1">//opcion2</span>
</span><span id="__span-14-5"><span class="n">DriveManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">URL</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div> <p>Este método intentará establecer una conexión con la base de datos según el URL indicado. Opcionalmente se le puede pasar el usuario y contraseña como argumento (también se puede indicar en la propia URL). Si la conexión es satisfactoria devolverá un objeto <code>Connection</code>.</p> <p>Ejemplo de conexión a la base de datos <em>prueba</em> en localhost:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><span class="c1">//mysql://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;db_name&gt;</span>
</span><span id="__span-15-2"><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"jdbc:mysql://localhost:3306/prueba"</span><span class="p">;</span>
</span><span id="__span-15-3"><span class="n">Connection</span><span class="w"> </span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="s">"root"</span><span class="p">,</span><span class="s">""</span><span class="p">);</span>
</span></code></pre></div></td></tr></table></div> <p>Este método puede lanzar dos tipos de excepciones (que habrá que manejar con un <em>try-catch</em>):</p> <ul> <li><code>SQLException</code>: la conexión no ha podido producirse. Puede ser por multitud de motivos como una URL mal formada, un error en la red, host o puerto incorrecto, base de datos no existente, usuario y contraseña no válidos, etc.</li> <li><code>SQLTimeOutException</code>: se ha superado el <code>LoginTimeout</code> sin recibir respuesta del servidor.</li> </ul> <div class="admonition info"> <p class="admonition-title">Recomendación</p> <p>Aquí podemos ver un vídeo en el que Makigas explica porqué en el mundo real no se usa <code>DriverManager.GetConnection()</code>:</p> <p><a href="https://youtu.be/71zLCxNuAq0?si=rfS44HEFaF3yxn0N"><img alt="porqué en el mundo real no se usa DriverManager.GetConnection()" src="https://img.youtube.com/vi/71zLCxNuAq0/0.jpg"/></a></p> </div> <h3 id="clase-connection">Clase <code>Connection</code><a class="headerlink" href="#clase-connection" title="Permanent link">¶</a></h3> <p><strong>Paso 2. Crear un objeto <code>Statement</code></strong></p> <p>Un objeto <strong><code>java.sql.Connection</code> representa una</strong> <strong>sesión de</strong> <strong>conexión con una base de datos</strong>. Una aplicación puede tener tantas conexiones como necesite, ya sea con una o varias bases de datos.</p> <p>El método más relevante es <strong><code>createStatement()</code></strong> que devuelve un objeto <code>Statement</code> asociado a dicha conexión que permite ejecutar sentencias SQL. El método <code>createStatement()</code> puede lanzar excepciones de tipo <code>SQLException</code>.</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><span class="n">Statement</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conn</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
</span></code></pre></div></td></tr></table></div> <p>Cuando ya no la necesitemos es aconsejable <strong>cerrar</strong> <strong>la conexión con <code>close()</code></strong> para liberar recursos:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><span class="n">conn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span></code></pre></div></td></tr></table></div> <h3 id="clase-statement">Clase <code>Statement</code><a class="headerlink" href="#clase-statement" title="Permanent link">¶</a></h3> <p><strong>Paso 3. Ejecutar sentencia SQL</strong></p> <p>Un objeto <strong><code>java.sql.Statement</code></strong> permite <strong>ejecutar</strong> <strong>sentencias SQL</strong> <strong>en</strong> <strong>la base de datos</strong> a través de la conexión con la que se creó el <code>Statement</code> (ver apartado anterior). Los tres métodos más comunes de ejecución de sentencias SQL son <code>executeQuery(…)</code>, <code>executeUpdate(…)</code> y <code>execute(…)</code>. Pueden lanzar excepciones de tipo <strong><code>SQLException</code></strong> y <strong><code>SQLTimeoutException</code></strong>.</p> <ul> <li><strong><code>ResultSet executeQuery(String sql)</code></strong>: ejecuta la sentencia sql indicada (de tipo <em>SELECT</em>). Devuelve un objeto <code>ResultSet</code> con los datos proporcionados por el servidor. </li> </ul> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="s">"SELECT * FROM vendedores"</span><span class="p">);</span>
</span></code></pre></div></td></tr></table></div> <ul> <li><strong><code>int executeUpdate(String sql)</code></strong>: ejecuta la sentencia SQL indicada (de tipo <em>DML</em> como por ejemplo <em>INSERT</em>, <em>UPDATE</em> o <em>DELETE</em>). Devuelve un el número de registros que han sido afectados (insertados, modificados o eliminados).</li> </ul> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><span class="kt">int</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="na">executeUpdate</span><span class="w"> </span><span class="p">(</span><span class="s">"INSERT INTO vendedores VALUES (1,'Pedro Gil', '2017-04-11', 15000);"</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div> <p>Cuando ya no lo necesitemos es aconsejable <strong>cerrar el <em><code>Statement</code></em> con <code>close()</code></strong> para liberar recursos:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><span class="n">st</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition info"> <p class="admonition-title">Definición</p> <p>Podríamos decir que este <em><code>ResultSet</code></em> es una especie de <em>tabla virtual</em> que se almacena en memoria con la información en su interior.</p> </div> <h3 id="clase-resultset">Clase <code>ResultSet</code><a class="headerlink" href="#clase-resultset" title="Permanent link">¶</a></h3> <p><strong>Paso 4. Leer el <code>Resultset</code></strong></p> <p>Un objeto <strong><code>java.sql.ResultSet</code></strong> contiene un conjunto de resultados (datos) obtenidos tras ejecutar una sentencia SQL, normalmente de tipo SELECT. Es una <strong>estructura de datos en forma de tabla</strong> con <strong>registros (filas)</strong> que podemos recorrer para acceder a la información de sus <strong>campos (columnas)</strong>.</p> <p><em><code>ResultSet</code></em> utiliza internamente un cursor que apunta al <em>registro actual</em> sobre el que podemos operar. Inicialmente dicho cursor está situado antes de la primera fila y disponemos de varios métodos para desplazar el cursor. El más común es <strong><code>next()</code></strong>:</p> <ul> <li><strong><code>boolean next()</code></strong>: mueve el cursor al siguiente registro. Devuelve <em><code>true</code></em> si fue posible y <em><code>false</code></em> en caso contrario (si ya llegamos al final de la tabla).</li> </ul> <p>Algunos de los métodos para obtener los datos del registro actual son:</p> <ul> <li><strong><code>String getString(String columnLabel)</code></strong>: devuelve un dato <code>String</code> de la columna indicada por su nombre. </li> </ul> <p>Por ejemplo: </p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1"><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">"nombre"</span><span class="p">);</span>
</span></code></pre></div></td></tr></table></div> <ul> <li><strong><code>String getString(int columnIndex)</code></strong>: devuelve un dato <code>String</code> de la columna indicada por su indice</li> </ul> <div class="admonition danger"> <p class="admonition-title">Ojo!</p> <p>La primera columna es la 1, no la cero 🤷🏾‍♂️</p> </div> <p>Por ejemplo: </p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</span></code></pre></div></td></tr></table></div> <p>Existen métodos análogos a los anteriores para obtener valores de tipo <code>int</code>, <code>long</code>, <code>float</code>, <code>double</code>, <code>boolean</code>, <code>Date</code>, <code>Time</code>, <code>Array</code>, etc. Pueden consultarse todos en la <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.sql/java/sql/ResultSet.html">documentación oficial de Java</a>.</p> <ul> <li> <p><strong><code>int getInt(String columnLabel)</code></strong></p> </li> <li> <p><strong><code>int getInt(int columnIndex)</code></strong></p> </li> <li> <p><strong><code>double getDouble(String columnLabel)</code></strong></p> </li> <li> <p><strong><code>double getDouble(int columnIndex)</code></strong></p> </li> <li> <p><strong><code>boolean getBoolean(String columnLabel)</code></strong></p> </li> <li> <p><strong><code>boolean getBoolean(int columnIndex)</code></strong></p> </li> <li> <p><strong><code>Date getDate(String columnLabel)</code></strong></p> </li> <li> <p><strong><code>Date getDate(int columnIndex)</code></strong></p> </li> <li> <p>etc.</p> </li> </ul> <p>Más adelante veremos cómo se realiza la modificación e inserción de datos.</p> <p>Todos estos métodos pueden lanzar una <strong><code>SQLException</code></strong>.</p> <p>Veamos un ejemplo de cómo recorrer un <code>ResultSet</code> llamado <code>rs</code> y mostrarlo por pantalla:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><span class="k">while</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-2"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">"id"</span><span class="p">);</span>
</span><span id="__span-23-3"><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">"nombre"</span><span class="p">);</span>
</span><span id="__span-23-4"><span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="n">fecha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getDate</span><span class="p">(</span><span class="s">"fecha_ingreso"</span><span class="p">);</span>
</span><span id="__span-23-5"><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">salario</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getFloat</span><span class="p">(</span><span class="s">"salario"</span><span class="p">);</span>
</span><span id="__span-23-6"><span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">" "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">" "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fecha</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">" "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">salario</span><span class="p">);</span>
</span><span id="__span-23-7"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <h2 id="navegabilidad-y-concurrencia">Navegabilidad y concurrencia<a class="headerlink" href="#navegabilidad-y-concurrencia" title="Permanent link">¶</a></h2> <p>Cuando invocamos a <code>createStatement()</code> <strong>sin</strong> <strong>argumentos</strong>, como hemos visto anteriormente, al ejecutar sentencias SQL obtendremos un <strong><code>ResultSet</code> por defecto en el que el cursor solo puede moverse hacia adelante y los datos son de solo lectura</strong>. A veces esto no es suficiente y necesitamos mayor funcionalidad.</p> <p>Por ello el método <code>createStatement()</code> está sobrecargado (existen varias versiones de dicho método) lo cual nos permite invocarlo con argumentos en los que podemos especificar el funcionamiento.</p> <ul> <li><strong><code>Statement createStatement (int resultSetType, int resultSetConcurrency)</code></strong>: devuelve un objeto <code>Statement</code> cuyos objetos <code>ResultSet</code> serán del tipo y concurrencia especificados. Los valores válidos son constantes definidas en <code>ResultSet</code>.</li> </ul> <p>Valores válidos para el <strong>argumento <code>resultSetType</code></strong> indica el tipo de <code>ResultSet</code>:</p> <ul> <li> <p><strong><code>ResultSet.TYPE_FORWARD_ONLY</code></strong>: <code>ResultSet</code> por defecto, <em>forward-only</em> y <em>no-actualizable</em>.</p> </li> <li> <p>Solo permite movimiento hacia delante con <code>next()</code>.</p> </li> <li> <p>Sus datos NO se actualizan. Es decir, no reflejará cambios producidos en la base de datos. Contiene una instantánea del momento en el que se realizó la consulta.</p> </li> <li> <p><strong><code>ResultSet.TYPE_SCROLL_INSENSITIVE</code></strong>: <code>ResultSet</code> desplazable y no actualizable.</p> </li> <li>Permite libertad de movimiento del cursor con otros métodos como <code>first()</code>, <code>previous()</code>, <code>last()</code>, etc. además de <code>next()</code>.</li> <li>Sus datos NO se actualizan, como en el caso anterior.</li> <li> <p><strong><code>ResultSet.TYPE_SCROLL_SENSITIVE</code></strong>: <code>ResultSet</code> desplazable y actualizable.</p> </li> <li> <p>Permite libertad de movimientos del cursor, como en el caso anterior.</p> </li> <li>Sus datos SÍ se actualizan. Es decir, mientras el <code>ResultSet</code> esté abierto se actualizará automáticamente con los cambios producidos en la base de datos. Esto puede suceder incluso mientras se está recorriendo el <code>ResultSet</code>, lo cual puede ser conveniente o contraproducente según el caso.</li> </ul> <div class="admonition info"> <p class="admonition-title">Diferencia entre <code>TYPE_SCROLL_INSENSITIVE</code> y <code>TYPE_SCROLL_SENSITIVE</code></p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._05_NavegabilidadConcurrencia</span><span class="p">;</span>
</span><span id="__span-24-2"><span class="kn">import</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_PoolObject.HikariCPSingleton</span><span class="p">;</span>
</span><span id="__span-24-3">
</span><span id="__span-24-4"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.*</span><span class="p">;</span>
</span><span id="__span-24-5">
</span><span id="__span-24-6"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EjemploScrollInsensitive</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-7">
</span><span id="__span-24-8"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-9"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-24-10"><span class="w">             </span><span class="n">Statement</span><span class="w"> </span><span class="n">stmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_SCROLL_INSENSITIVE</span><span class="p">,</span><span class="w"> </span><span class="n">ResultSet</span><span class="p">.</span><span class="na">CONCUR_READ_ONLY</span><span class="p">);</span>
</span><span id="__span-24-11"><span class="w">             </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="s">"SELECT id, name FROM characters"</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-12">
</span><span id="__span-24-13"><span class="w">            </span><span class="c1">// Mover a la primera fila</span>
</span><span id="__span-24-14"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">first</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-15"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"primera fila: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">"id"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">", "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">"name"</span><span class="p">));</span>
</span><span id="__span-24-16"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-24-17">
</span><span id="__span-24-18"><span class="w">            </span><span class="c1">// Mover a la última fila</span>
</span><span id="__span-24-19"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">last</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-20"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"última fila: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">"id"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">", "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">"name"</span><span class="p">));</span>
</span><span id="__span-24-21"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-24-22">
</span><span id="__span-24-23"><span class="w">            </span><span class="c1">// Simulamos un retraso y actualizamos la base de datos (en otra sesión)</span>
</span><span id="__span-24-24"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Esperando las actualizaciones..."</span><span class="p">);</span>
</span><span id="__span-24-25"><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span><span class="w"> </span><span class="c1">// Esperar 10 segundos</span>
</span><span id="__span-24-26">
</span><span id="__span-24-27"><span class="w">            </span><span class="c1">// Mover a la primera fila otra vez</span>
</span><span id="__span-24-28"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">first</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-29"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"primera fila después de esperar: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">"id"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">", "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">"name"</span><span class="p">));</span>
</span><span id="__span-24-30"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-24-31">
</span><span id="__span-24-32"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-33"><span class="w">            </span><span class="n">ex</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
</span><span id="__span-24-34"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-24-35"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-24-36"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <p>En este ejemplo, incluso si la base de datos cambia mientras el programa está esperando (durante el <code>Thread.sleep(10000)</code>), el ResultSet no reflejará esos cambios cuando se vuelva a consultar la primera fila.</p> <p>En caso de cambiar el valor <code>TYPE_SCROLL_INSENSITIVE</code> por <code>TYPE_SCROLL_SENSITIVE</code>, si hay cambios en la base de datos durante el tiempo de espera, el ResultSet reflejará esos cambios cuando se vuelva a consultar la primera fila. Por ejemplo, si se actualiza el nombre del primer registro en la base de datos mientras el programa espera, el nuevo nombre aparecerá en la salida.</p> <p>Estos ejemplos demuestran cómo <code>TYPE_SCROLL_INSENSITIVE</code> no refleja cambios en la base de datos después de su creación, mientras que <code>TYPE_SCROLL_SENSITIVE</code> sí lo hace.</p> </div> <p>El <strong>argumento</strong> <strong><code>ResultSet.Concurrency</code></strong> indica la concurrencia del <code>ResultSet</code>:</p> <ul> <li><strong><code>ResultSet.CONCUR_READ_ONLY</code></strong>: solo lectura. Es el valor por defecto.</li> <li><strong><code>ResultSet.CONCUR_UPDATABLE</code></strong>: permite modificar los datos almacenados en el <code>ResultSet</code> para luego aplicar los cambios sobre la base de datos (más adelante se verá cómo).</li> </ul> <div class="admonition info"> <p class="admonition-title">Importante</p> <p>El <code>ResultSet</code> por defecto que se obtiene con <code>createStatement()</code> sin argumentos es el mismo que con <code>createStatement(ResultSet.TYPE_FORWARD_ONLY, ResultSet.CONCUR_READ_ONLY)</code>. </p> </div> <h2 id="consultas-query">Consultas (<code>Query</code>)<a class="headerlink" href="#consultas-query" title="Permanent link">¶</a></h2> <h3 id="navegacion-de-un-resultset">Navegación de un <code>ResultSet</code><a class="headerlink" href="#navegacion-de-un-resultset" title="Permanent link">¶</a></h3> <p>Como ya se ha visto, en un objeto <em>ResultSet</em> se encuentran los resultados de la ejecución de una sentencia SQL. Por lo tanto, un objeto <em>ResultSet</em> contiene las filas que satisfacen las condiciones de una sentencia SQL, y ofrece métodos de navegación por los registros como <em>next()</em> que desplaza el cursos al siguiente registro del <em>ResultSet</em>.</p> <p>Además de este método de desplazamiento básico, existen otros de desplazamiento libre que podremos utilizar siempre y cuando el <em>ResultSet</em> sea de tipo <em><code>ResultSet.TYPE_SCROLL_INSENSITIVE</code></em> o <em>ResultSet.TYPE_SCROLL_SENSITIVE</em> como se ha dicho antes.</p> <p>Algunos de estos métodos son:</p> <ul> <li> <p><strong><code>void beforeFirst()</code></strong>: mueve el cursor antes de la primera fila.</p> </li> <li> <p><strong><code>boolean first()</code></strong>: mueve el cursor a la primera fila.</p> </li> <li> <p><strong><code>boolean next()</code></strong>: mueve el cursor a la siguiente fila. Permitido en todos los tipos de ResultSet.</p> </li> <li> <p><strong><code>boolean previous()</code></strong>: mueve el cursor a la fila anterior.</p> </li> <li> <p><strong><code>boolean last()</code></strong>: mueve el cursor a la última fila.</p> </li> <li> <p><strong><code>void afterLast()</code></strong>: mover el cursor después de la última fila.</p> </li> <li> <p><strong><code>boolean absolute(int row)</code></strong>: posiciona el cursor en el número de registro indicado. Hay que tener en cuenta que el primer registro es el 1, no el cero. </p> <div class="admonition info"> <p class="admonition-title"><code>absolute(n)</code></p> <p><code>absolute(7)</code> desplazará el cursor al séptimo registro. Si valor es negativo se posiciona en el número de registro indicado pero empezando a contar desde el final (el último es el -1). Por ejemplo si tiene 10 registros y llamamos <code>absolute(-2)</code> se desplazará al registro número 9.</p> </div> </li> <li> <p><strong><code>boolean relative(int registros)</code></strong>: desplaza el cursor un número relativo de registros, que puede ser positivo o negativo. </p> <div class="admonition info"> <p class="admonition-title"><code>relative(n)</code></p> <p>Si el cursor está en el registro 5 y llamamos a <code>relative(10)</code> se desplazará al registro número 15. Si luego llamamos a <code>relative(-4)</code> se desplazará al registro 11.</p> </div> </li> </ul> <p>Los métodos que devuelven un tipo <code>boolean</code> devolverán <code>true</code> si ha sido posible mover el cursor a un registro válido, y <code>false</code> en caso contrario, por ejemplo si no tiene ningún registro o hemos saltado a un número de registro que no existe.</p> <p>Todos estos métodos pueden producir una excepción de tipo <code>SQLException</code>.</p> <p>También existen otros métodos relacionados con la posición del cursor.</p> <ul> <li><strong><code>int getRow()</code></strong>: devuelve el número de registro actual. Cero si no hay registro actual.</li> <li><strong><code>boolean isBeforeFirst()</code></strong>: devuelve <em>true</em> si el cursor está antes del primer registro.</li> <li><strong><code>boolean isFirst()</code></strong>: devuelve <em>true</em> si el cursor está en el primer registro.</li> <li><strong><code>boolean isLast()</code></strong>: devuelve <em>true</em> si el cursor está en el último registro.</li> <li><strong><code>boolean isAfterLast()</code></strong>: devuelve <em>true</em> si el cursor está después del último registro.</li> </ul> <h3 id="obteniendo-datos-del-resultset">Obteniendo datos del <code>ResultSet</code><a class="headerlink" href="#obteniendo-datos-del-resultset" title="Permanent link">¶</a></h3> <p>Los métodos <code>getXXX()</code> ofrecen los medios para recuperar los valores de las columnas (campos) de la fila (registro) actual del <code>ResultSet</code>. No es necesario que las columnas sean obtenidas utilizando un orden determinado.</p> <p>Para designar una columna podemos utilizar su nombre o bien su número (empezando por 1).</p> <p>Por ejemplo si la segunda columna de un objeto <code>ResultSet</code> se llama <code>titulo</code> y almacena datos de tipo <code>String</code>, se podrá recuperar su valor de las dos formas siguientes:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><span class="c1">// rs es un objeto ResultSet</span>
</span><span id="__span-25-2"><span class="n">String</span><span class="w"> </span><span class="n">valor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-25-3"><span class="n">String</span><span class="w"> </span><span class="n">valor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">"titulo"</span><span class="p">);</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition warning"> <p class="admonition-title">Importante</p> <p>Es importante tener en cuenta que las columnas se numeran de izquierda a derecha y que la primera es la número 1, no la cero. También que las columnas no son case sensitive, es decir, no distinguen entre mayúsculas y minúsculas.</p> </div> <div class="admonition example"> <p class="admonition-title">Ejemplo</p> <p>La información referente a las columnas de un <code>ResultSet</code> se puede obtener llamando al <strong>método <code>getMetaData()</code></strong> que devolverá un objeto <code>ResultSetMetaData</code> que contendrá el número, tipo y propiedades de las columnas del <code>ResultSet</code>.</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._06_Consultas</span><span class="p">;</span>
</span><span id="__span-26-2">
</span><span id="__span-26-3"><span class="kn">import</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_PoolObject.HikariCPSingleton</span><span class="p">;</span>
</span><span id="__span-26-4">
</span><span id="__span-26-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.*</span><span class="p">;</span>
</span><span id="__span-26-6">
</span><span id="__span-26-7"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EjemploResultSetMetaData</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-8"><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-9"><span class="w">     </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-26-10"><span class="w">          </span><span class="n">Statement</span><span class="w"> </span><span class="n">stmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
</span><span id="__span-26-11"><span class="w">          </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="s">"SELECT id, episode, title FROM films"</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-12">
</span><span id="__span-26-13"><span class="w">         </span><span class="c1">// Obtener metadata del ResulSet</span>
</span><span id="__span-26-14"><span class="w">         </span><span class="n">ResultSetMetaData</span><span class="w"> </span><span class="n">rsmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getMetaData</span><span class="p">();</span>
</span><span id="__span-26-15">
</span><span id="__span-26-16"><span class="w">         </span><span class="c1">// Obtener el número de columnas</span>
</span><span id="__span-26-17"><span class="w">         </span><span class="kt">int</span><span class="w"> </span><span class="n">columnCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rsmd</span><span class="p">.</span><span class="na">getColumnCount</span><span class="p">();</span>
</span><span id="__span-26-18"><span class="w">         </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Número de columnas: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">columnCount</span><span class="p">);</span>
</span><span id="__span-26-19">
</span><span id="__span-26-20"><span class="w">         </span><span class="c1">// Listar las columnas de detalles</span>
</span><span id="__span-26-21"><span class="w">         </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">columnCount</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-22"><span class="w">             </span><span class="n">String</span><span class="w"> </span><span class="n">columnName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rsmd</span><span class="p">.</span><span class="na">getColumnName</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span><span id="__span-26-23"><span class="w">             </span><span class="n">String</span><span class="w"> </span><span class="n">columnType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rsmd</span><span class="p">.</span><span class="na">getColumnTypeName</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span><span id="__span-26-24"><span class="w">             </span><span class="kt">int</span><span class="w"> </span><span class="n">columnDisplaySize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rsmd</span><span class="p">.</span><span class="na">getColumnDisplaySize</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span><span id="__span-26-25"><span class="w">             </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isNullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rsmd</span><span class="p">.</span><span class="na">isNullable</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ResultSetMetaData</span><span class="p">.</span><span class="na">columnNullable</span><span class="p">;</span>
</span><span id="__span-26-26">
</span><span id="__span-26-27"><span class="w">             </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Columna "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">":"</span><span class="p">);</span>
</span><span id="__span-26-28"><span class="w">             </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"  Nombre: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">columnName</span><span class="p">);</span>
</span><span id="__span-26-29"><span class="w">             </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"  Tipo: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">columnType</span><span class="p">);</span>
</span><span id="__span-26-30"><span class="w">             </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"  Tamaño display: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">columnDisplaySize</span><span class="p">);</span>
</span><span id="__span-26-31"><span class="w">             </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"  Nullable: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">isNullable</span><span class="p">);</span>
</span><span id="__span-26-32"><span class="w">         </span><span class="p">}</span>
</span><span id="__span-26-33">
</span><span id="__span-26-34"><span class="w">         </span><span class="c1">// Iterar sobre el conjunto de resultados</span>
</span><span id="__span-26-35"><span class="w">         </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-36"><span class="w">             </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">columnCount</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-37"><span class="w">                 </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">" "</span><span class="p">);</span>
</span><span id="__span-26-38"><span class="w">             </span><span class="p">}</span>
</span><span id="__span-26-39"><span class="w">             </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">();</span>
</span><span id="__span-26-40"><span class="w">         </span><span class="p">}</span>
</span><span id="__span-26-41">
</span><span id="__span-26-42"><span class="w">     </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-43"><span class="w">         </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Error de SQL: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-26-44"><span class="w">     </span><span class="p">}</span>
</span><span id="__span-26-45"><span class="w"> </span><span class="p">}</span>
</span><span id="__span-26-46"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <p>Esto provocará la siguiente salida por pantalla:</p> <div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1">Número de columnas: 3
</span><span id="__span-27-2">Columna 1:
</span><span id="__span-27-3">Nombre: id
</span><span id="__span-27-4">Tipo: INT
</span><span id="__span-27-5">Tamaño display: 10
</span><span id="__span-27-6">Nullable: false
</span><span id="__span-27-7">Columna 2:
</span><span id="__span-27-8">Nombre: episode
</span><span id="__span-27-9">Tipo: VARCHAR
</span><span id="__span-27-10">Tamaño display: 12
</span><span id="__span-27-11">Nullable: true
</span><span id="__span-27-12">Columna 3:
</span><span id="__span-27-13">Nombre: title
</span><span id="__span-27-14">Tipo: VARCHAR
</span><span id="__span-27-15">Tamaño display: 30
</span><span id="__span-27-16">Nullable: true
</span><span id="__span-27-17">1 Episode I The Phantom Menace 
</span><span id="__span-27-18">2 Episode II Attack of the Clones 
</span><span id="__span-27-19">3 Episode III Revenge of the Sith 
</span><span id="__span-27-20">4 Episode IV A New Hope 
</span><span id="__span-27-21">5 Episode V The Empire Strikes Back 
</span><span id="__span-27-22">6 Episode VI Return of the Jedi 
</span></code></pre></div></td></tr></table></div> </div> <p>Si conocemos el nombre de una columna, pero no su índice, el método <code>findColumn()</code> puede ser utilizado para obtener el número de columna, pasándole como argumento un objeto <code>String</code> que sea el nombre de la columna correspondiente, este método nos devolverá un entero que será el índice correspondiente a la columna.</p> <h3 id="tipos-de-datos-y-conversiones">Tipos de datos y conversiones<a class="headerlink" href="#tipos-de-datos-y-conversiones" title="Permanent link">¶</a></h3> <p>Cuando se lanza un método <code>getXXX()</code> determinado sobre un objeto <code>ResultSet</code> para obtener el valor de un campo del registro actual, el driver JDBC convierte el dato que se quiere recuperar al tipo Java especificado y entonces devuelve un valor Java adecuado. Por ejemplo si utilizamos el método <code>getString()</code> y el tipo del dato en la base de datos es <em><code>VARCHAR</code></em>, el driver JDBC convertirá el dato <code>VARCHAR</code> de tipo SQL a un objeto <code>String</code> de Java.</p> <p>Algo parecido sucede con otros tipos de datos SQL como por ejemplo <code>DATE</code>. Podremos acceder a él tanto con <code>getDate()</code> como con <code>getString()</code>. La diferencia es que el primero devolverá un objeto Java de tipo <code>Date</code> y el segundo devolverá un <code>String</code>.</p> <p>Siempre que sea posible el driver JDBC convertirá el tipo de dato almacenado en la base de datos al tipo solicitado por el método <code>getXXX()</code>, pero hay conversiones que no se pueden realizar y lanzarán una excepción, como por ejemplo si intentamos hacer un <code>getInt()</code> sobre un campo que no contiene un valor numérico.</p> <h3 id="sentencias-que-no-devuelven-datos">Sentencias que no devuelven datos<a class="headerlink" href="#sentencias-que-no-devuelven-datos" title="Permanent link">¶</a></h3> <p>Las ejecutamos con el método <code>executeUpdate</code>. Serán todas las sentencias SQL <strong>excepto el SELECT</strong>, que es la de consulta. Es decir, nos servirá para las siguientes sentencias:</p> <ul> <li>Sentencias que cambian las estructuras internas de la BD donde se guardan los datos (instrucciones conocidas con las siglas <strong>DDL</strong>, del inglés <strong>Data Definition Language</strong>), como por ejemplo <code>CREATE TABLE</code>, <code>CREATE VIEW</code>, <code>ALTER TABLE</code>, <code>DROP TABLE</code>, …,</li> <li>Sentencias para otorgar permisos a los usuarios existentes o crear otros nuevos (subgrupo de instrucciones conocidas como <strong>DCL</strong> o <strong>Data Control Language</strong>), como por ejemplo <code>GRANT</code>.</li> <li>Y también las sentencias para modificar los datos guardados utilizando las instrucciones <code>INSERT</code>, <code>UPDATE</code> y <code>DELETE</code>.</li> </ul> <p>Aunque se trata de sentencias muy dispares, desde el punto de vista de la comunicación con el SGBD se comportan de manera muy similar, siguiendo el siguiente patrón:</p> <ol> <li><strong>Instanciación del <code>Statement</code></strong> a partir de una conexión activa.</li> <li><strong>Ejecución de una sentencia SQL</strong> pasada por parámetro al método <code>executeUpdate</code>.</li> <li><strong>Cierre del objeto</strong> <code>Statement</code> instanciado.</li> </ol> <p>Miremos este ejemplo, en el que </p> <div class="admonition example"> <p class="admonition-title">Vamos a crear una tabla muy sencilla en la Base de Datos MySql</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><span class="o">[</span><span class="p">...</span><span class="o">]</span>
</span><span id="__span-28-2"><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">createTable</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-28-3"><span class="w">   </span><span class="n">Statement</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span><span class="w"> </span>
</span><span id="__span-28-4"><span class="w">   </span><span class="n">st</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">(</span><span class="s">"CREATE TABLE T1 (c1 varchar(50))"</span><span class="p">);</span><span class="w"> </span>
</span><span id="__span-28-5"><span class="w">   </span><span class="n">st</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w"> </span>
</span><span id="__span-28-6"><span class="p">}</span>
</span><span id="__span-28-7"><span class="o">[</span><span class="p">...</span><span class="o">]</span>
</span></code></pre></div></td></tr></table></div> </div> <h3 id="asegurar-la-liberacion-de-recursos">Asegurar la liberación de recursos<a class="headerlink" href="#asegurar-la-liberacion-de-recursos" title="Permanent link">¶</a></h3> <p>Las instancias de <code>Connection</code> y las de <code>Statement</code> guardan, en memoria, mucha información relacionada con las ejecuciones realizadas. Además, mientras continúan activas mantienen en el SGBD una sesión abierta, que supondrá un conjunto importante de recursos abiertos, destinados a servir de forma eficiente las peticiones de los clientes. Es importante cerrar estos objetos para liberar recursos tanto del cliente como del servidor.</p> <p>Si en un mismo método debemos cerrar un objeto <code>Statement</code> y el <code>Connection</code> a partir del cual la hemos creado, se deberá cerrar primero el <code>Statement</code> y después el <code>Connection</code>. Si lo hacemos al revés, cuando intentamos cerrar el <code>Statement</code> nos saltará una excepción de tipo <code>SQLException</code>, ya que el cierre de la conexión le habría dejado inaccesible.</p> <p>Además de respetar el orden, asegurar la liberación de los recursos situando las operaciones de cierre dentro de un bloque <code>finally</code>. De este modo, aunque se produzcan errores, no se dejarán de ejecutar las instrucciones de cierre.</p> <p>Hay que tener en cuenta todavía un detalle más cuando sea necesario realizar el cierre de varios objetos a la vez. En este caso, aunque las situamos una tras otra, todas las instrucciones de cierre dentro del bloque <code>finally</code>, no sería suficiente garantía para asegurar la ejecución de todos los cierres, ya que, si mientras se produce el cierre de un los objetos se lanza una excepción, los objetos invocados en una posición posterior a la del que se ha producido el error no se cerrarán.</p> <p>La solución de este problema pasa por evitar el lanzamiento de cualquier excepción durante el proceso de cierre. Una posible forma es encapsular cada cierre entre sentencias <code>try-catch</code> dentro del <code>finally</code>.</p> <div class="admonition example"> <p class="admonition-title">Aquí tenéis un ejemplo completo:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._06_Consultas</span><span class="p">;</span>
</span><span id="__span-29-2">
</span><span id="__span-29-3"><span class="kn">import</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_PoolObject.HikariCPSingleton</span><span class="p">;</span>
</span><span id="__span-29-4">
</span><span id="__span-29-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
</span><span id="__span-29-6"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.ResultSet</span><span class="p">;</span>
</span><span id="__span-29-7"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
</span><span id="__span-29-8"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Statement</span><span class="p">;</span>
</span><span id="__span-29-9">
</span><span id="__span-29-10"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">LiberacionRecursos</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-11"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">Statement</span><span class="w"> </span><span class="n">stmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-29-12"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-29-13"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="p">;</span>
</span><span id="__span-29-14">
</span><span id="__span-29-15"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-16"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-17"><span class="w">            </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-29-18"><span class="w">            </span><span class="n">stmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
</span><span id="__span-29-19"><span class="w">            </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="s">"SELECT id, name, hair_color FROM characters"</span><span class="p">);</span>
</span><span id="__span-29-20">
</span><span id="__span-29-21"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-22"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"\t"</span><span class="p">);</span>
</span><span id="__span-29-23"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"\t"</span><span class="p">);</span>
</span><span id="__span-29-24"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>
</span><span id="__span-29-25"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-29-26"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-27"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Error de SQL: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-29-28"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-29"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-30"><span class="w">                </span><span class="c1">//Siempre se debe cerrar todo lo abierto</span>
</span><span id="__span-29-31"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rs</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-32"><span class="w">                    </span><span class="n">rs</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span><span id="__span-29-33"><span class="w">                </span><span class="p">}</span>
</span><span id="__span-29-34"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">sql</span><span class="p">.</span><span class="na">SQLException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-35"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"ERROR: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-29-36"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-29-37"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-38"><span class="w">                </span><span class="c1">//Siempre se debe cerrar todo lo abierto</span>
</span><span id="__span-29-39"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">stmt</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-40"><span class="w">                    </span><span class="n">stmt</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span><span id="__span-29-41"><span class="w">                </span><span class="p">}</span>
</span><span id="__span-29-42"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">sql</span><span class="p">.</span><span class="na">SQLException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-43"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"ERROR: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-29-44"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-29-45"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-46"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-47"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <p>De todos modos recuerda que lo más fácil es usar <code>try-with-resources</code> y que se encarge Java de cerrar los recursos que hemos usado dentro del <code>try</code>.</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._06_Consultas</span><span class="p">;</span>
</span><span id="__span-30-2">
</span><span id="__span-30-3"><span class="kn">import</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_PoolObject.HikariCPSingleton</span><span class="p">;</span>
</span><span id="__span-30-4">
</span><span id="__span-30-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
</span><span id="__span-30-6"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.ResultSet</span><span class="p">;</span>
</span><span id="__span-30-7"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
</span><span id="__span-30-8"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Statement</span><span class="p">;</span>
</span><span id="__span-30-9">
</span><span id="__span-30-10"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">LiberacionRecursosTryWithResources</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-11"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-12"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-30-13"><span class="w">             </span><span class="n">Statement</span><span class="w"> </span><span class="n">stmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
</span><span id="__span-30-14"><span class="w">             </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="s">"SELECT id, name, hair_color FROM characters"</span><span class="p">);)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-15">
</span><span id="__span-30-16"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-17"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"\t"</span><span class="p">);</span>
</span><span id="__span-30-18"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"\t"</span><span class="p">);</span>
</span><span id="__span-30-19"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>
</span><span id="__span-30-20"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-30-21"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-22"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Error de SQL: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-30-23"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-30-24"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-25"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> <p><strong>Comparación y Recomendación</strong></p> <ul> <li><strong>Claridad y Simplicidad</strong>: <code>try-with-resources</code> es más claro y conciso, reduciendo la cantidad de código y evitando errores comunes al cerrar recursos manualmente.</li> <li><strong>Seguridad</strong>: <code>try-with-resources</code> garantiza que los recursos se cierren en el orden correcto y automáticamente, incluso si ocurre una excepción.</li> <li><strong>Compatibilidad</strong>: <code>try-with-resources</code> requiere Java 7 o superior, pero dado que las versiones anteriores de Java ya no son compatibles en la mayoría de los entornos, esto no suele ser un problema.</li> </ul> </div> <h2 id="modificacion-update">Modificación (<code>update</code>)<a class="headerlink" href="#modificacion-update" title="Permanent link">¶</a></h2> <p>Para poder modificar los datos que contiene un <code>ResultSet</code> necesitamos un <code>ResultSet</code> de tipo modificable. Para ello debemos utilizar la constante <code>ResultSet.CONCUR_UPDATABLE</code> al llamar al método <code>createStatement()</code> como se ha visto antes.</p> <p>Para modificar los valores de un registro existente se utilizan una serie de métodos <strong><code>updateXXX()</code></strong> de <code>ResultSet</code>. Las XXX indican el tipo del dato y hay tantos distintos como sucede con los métodos <code>getXXX()</code> de este mismo interfaz: <code>updateString()</code>, <code>updateInt()</code>, <code>updateDouble()</code>, <code>updateDate()</code>, etc.</p> <p>La diferencia es que <strong>los métodos <code>updateXXX()</code> necesitan dos argumentos</strong>:</p> <ul> <li>La columna que deseamos actualizar (por su nombre o por su número de columna).</li> <li>El valor que queremos almacenar en dicha columna (del tipo que sea).</li> </ul> <p>Por ejemplo para modificar el campo <code>edad</code> almacenando el entero <code>28</code> habría que llamar al siguiente método, suponiendo que <code>rs</code> es un objeto <code>ResultSet</code>:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1"><span class="n">rs</span><span class="p">.</span><span class="na">updateInt</span><span class="p">(</span><span class="s">"edad"</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">);</span>
</span></code></pre></div></td></tr></table></div> <p>También podría hacerse de la siguiente manera, suponiendo que la columna <code>edad</code> es la segunda:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-32-1"><span class="n">rs</span><span class="p">.</span><span class="na">updateInt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">);</span>
</span></code></pre></div></td></tr></table></div> <p>Los métodos <code>updateXXX()</code> no devuelven ningún valor (son de tipo <code>void</code>). Si se produce algún error se lanzará una <code>SQLException</code>.</p> <p>Posteriormente hay que <strong>llamar a <code>updateRow()</code> para que los cambios realizados se apliquen sobre la base de datos</strong>. El <em>Driver JDBC</em> se encargará de ejecutar las sentencias SQL necesarias. Esta es una característica muy potente ya que nos facilita enormemente la tarea de modificar los datos de una base de datos.</p> <p>En resumen, el proceso para realizar la modificación de una fila de un <code>ResultSet</code> es el siguiente:</p> <ol> <li><strong>Desplazamos el cursor</strong> al registro que queremos modificar.</li> <li>Llamamos a todos los métodos <strong><code>updateXXX(...)</code></strong> que necesitemos.</li> <li>Llamamos a <strong><code>updateRow()</code></strong> para que los cambios se apliquen a la base de datos.</li> </ol> <div class="admonition warning"> <p class="admonition-title">Importante</p> <p>Hay que llamar a <code>updateRow()</code> antes de desplazar el cursor**. Si desplazamos el cursor antes de llamar a <code>updateRow()</code>, se perderán los cambios.</p> <p>Si queremos <strong>cancelar las modificaciones</strong> <strong>de un registro del <code>ResultSet</code></strong> podemos llamar a <strong><code>cancelRowUpdates()</code></strong>, que cancela todas las modificaciones realizadas sobre el registro actual.</p> <p>Si ya hemos llamado a <code>updateRow()</code> el método <code>cancelRowUpdates()</code> no tendrá ningún efecto.</p> <p>El siguiente código de ejemplo muestra cómo modificar el campo <code>title</code> del último registro de un <code>ResultSet</code> que contiene el resultado de una <em>SELECT</em> sobre la tabla de <code>films</code>: </p><div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._07_Modificacion</span><span class="p">;</span>
</span><span id="__span-33-2">
</span><span id="__span-33-3"><span class="kn">import</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_PoolObject.HikariCPSingleton</span><span class="p">;</span>
</span><span id="__span-33-4">
</span><span id="__span-33-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.*</span><span class="p">;</span>
</span><span id="__span-33-6">
</span><span id="__span-33-7"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EjemploUpdateRow</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-8">
</span><span id="__span-33-9"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-10"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"SELECT * FROM films"</span><span class="p">;</span>
</span><span id="__span-33-11"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-33-12"><span class="w">             </span><span class="c1">// Creamos un Statement scrollable y modificable</span>
</span><span id="__span-33-13"><span class="w">             </span><span class="n">Statement</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_SCROLL_SENSITIVE</span><span class="p">,</span><span class="w"> </span><span class="n">ResultSet</span><span class="p">.</span><span class="na">CONCUR_UPDATABLE</span><span class="p">);</span>
</span><span id="__span-33-14"><span class="w">             </span><span class="c1">// Ejecutamos un SELECT y obtenemos la tabla films en un ResultSet</span>
</span><span id="__span-33-15"><span class="w">             </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="n">sql</span><span class="p">);)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-16"><span class="w">            </span><span class="c1">// Nos movemos al último registro y lo actualizamos</span>
</span><span id="__span-33-17"><span class="w">            </span><span class="n">rs</span><span class="p">.</span><span class="na">last</span><span class="p">();</span>
</span><span id="__span-33-18"><span class="w">            </span><span class="n">rs</span><span class="p">.</span><span class="na">updateString</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">"Return Of The Jedi"</span><span class="p">);</span><span class="w"> </span><span class="c1">// Ponemos todas las palabras en mayúsculas</span>
</span><span id="__span-33-19"><span class="w">            </span><span class="n">rs</span><span class="p">.</span><span class="na">updateRow</span><span class="p">();</span>
</span><span id="__span-33-20"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-21"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Error de SQL: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-33-22"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-33-23"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-33-24"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> </div> <h2 id="insercion-insert">Inserción (<code>insert</code>)<a class="headerlink" href="#insercion-insert" title="Permanent link">¶</a></h2> <p>Para insertar nuevos registros necesitaremos utilizar, al menos, estos dos métodos:</p> <ul> <li><strong><code>void moveToInsertRow()</code></strong>: desplaza el cursor al <em>registro de inserción</em>. Es un registro especial utilizado para insertar nuevos registros en el <code>ResultSet</code>. Posteriormente tendremos que llamar a los métodos <code>updateXXX()</code> ya conocidos para establecer los valores del registro de inserción. Para finalizar hay que llamar a <code>insertRow()</code>.</li> <li> <p><strong><code>void insertRow()</code></strong>: inserta el <em>registro de inserción</em> en el <code>ResultSet</code>, pasando a ser un registro normal más, y también lo inserta en la base de datos.</p> <div class="admonition example"> <p class="admonition-title">El siguiente código inserta un nuevo registro en la tabla <code>films</code>:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-34-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._08_Insercion</span><span class="p">;</span>
</span><span id="__span-34-2">
</span><span id="__span-34-3"><span class="kn">import</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_PoolObject.HikariCPSingleton</span><span class="p">;</span>
</span><span id="__span-34-4">
</span><span id="__span-34-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
</span><span id="__span-34-6"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.ResultSet</span><span class="p">;</span>
</span><span id="__span-34-7"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
</span><span id="__span-34-8"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Statement</span><span class="p">;</span>
</span><span id="__span-34-9">
</span><span id="__span-34-10"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EjemploMoveToInsertRow</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-11"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-12"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"SELECT * FROM films"</span><span class="p">;</span>
</span><span id="__span-34-13"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-34-14"><span class="w">             </span><span class="n">Statement</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_SCROLL_SENSITIVE</span><span class="p">,</span><span class="w"> </span><span class="n">ResultSet</span><span class="p">.</span><span class="na">CONCUR_UPDATABLE</span><span class="p">);</span>
</span><span id="__span-34-15"><span class="w">             </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="n">sql</span><span class="p">);)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-16"><span class="w">            </span><span class="c1">// Creamos un nuevo registro y lo insertamos</span>
</span><span id="__span-34-17"><span class="w">            </span><span class="n">rs</span><span class="p">.</span><span class="na">moveToInsertRow</span><span class="p">();</span>
</span><span id="__span-34-18"><span class="w">            </span><span class="n">rs</span><span class="p">.</span><span class="na">updateInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">);</span>
</span><span id="__span-34-19"><span class="w">            </span><span class="n">rs</span><span class="p">.</span><span class="na">updateString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">"Episode VII"</span><span class="p">);</span>
</span><span id="__span-34-20"><span class="w">            </span><span class="n">rs</span><span class="p">.</span><span class="na">updateString</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">"The force awakens"</span><span class="p">);</span>
</span><span id="__span-34-21"><span class="w">            </span><span class="n">rs</span><span class="p">.</span><span class="na">insertRow</span><span class="p">();</span>
</span><span id="__span-34-22"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-23"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Error de SQL: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-34-24"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-34-25"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-26"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> </div> </li> </ul> <p>Los campos cuyo valor no se haya establecido con <code>updateXXX()</code> tendrán un valor <code>NULL</code>. Si en la base de datos dicho campo no está configurado para admitir nulos se producirá una <code>SQLException</code>.</p> <p>Tras insertar nuestro nuevo registro en el objeto <code>ResultSet</code> podremos volver a la anterior posición en la que se encontraba el cursor (antes de invocar <code>moveToInsertRow()</code> ) llamando al método <code>moveToCurrentRow()</code>. Este método sólo se puede utilizar en combinación con <code>moveToInsertRow()</code>.</p> <div class="admonition example"> <p class="admonition-title">Ejemplo</p> <p>El siguiente ejemplo muestra como usar sentencias SQL para realizar la inserción de nuevos registros, ya veremos que esta no es la forma más aconsejable por seguridad.</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-35-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._08_Insercion</span><span class="p">;</span>
</span><span id="__span-35-2">
</span><span id="__span-35-3"><span class="kn">import</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_PoolObject.HikariCPSingleton</span><span class="p">;</span>
</span><span id="__span-35-4">
</span><span id="__span-35-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.*</span><span class="p">;</span>
</span><span id="__span-35-6">
</span><span id="__span-35-7"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EjemploInsercionConSQL</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-8">
</span><span id="__span-35-9"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">insertFilmFijo</span><span class="p">(){</span>
</span><span id="__span-35-10"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"INSERT INTO films (id, episode, title) VALUES (7, 'Episode VII', 'The force awakens')"</span><span class="p">;</span>
</span><span id="__span-35-11"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-35-12"><span class="w">             </span><span class="c1">// Creamos un Statement scrollable y modificable</span>
</span><span id="__span-35-13"><span class="w">             </span><span class="n">Statement</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_SCROLL_SENSITIVE</span><span class="p">,</span><span class="w"> </span><span class="n">ResultSet</span><span class="p">.</span><span class="na">CONCUR_UPDATABLE</span><span class="p">);</span>
</span><span id="__span-35-14"><span class="w">             </span><span class="c1">// Ejecutamos un SELECT y obtenemos la tabla films en un ResultSet</span>
</span><span id="__span-35-15"><span class="w">             </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="n">sql</span><span class="p">);)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-16"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-17"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"ERROR al insertar el film: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-35-18"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-35-19"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-35-20">
</span><span id="__span-35-21"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">insertFilmParametros</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">episode</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">){</span>
</span><span id="__span-35-22"><span class="w">        </span><span class="c1">// OJO!! Forma no recomendada por problemas de seguridad (SQL Injection)</span>
</span><span id="__span-35-23"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"INSERT INTO films (id, episode, title) VALUES ("</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">", '"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">episode</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"', '"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"')"</span><span class="p">;</span>
</span><span id="__span-35-24"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-35-25"><span class="w">             </span><span class="c1">// Creamos un Statement scrollable y modificable</span>
</span><span id="__span-35-26"><span class="w">             </span><span class="n">Statement</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_SCROLL_SENSITIVE</span><span class="p">,</span><span class="w"> </span><span class="n">ResultSet</span><span class="p">.</span><span class="na">CONCUR_UPDATABLE</span><span class="p">);</span>
</span><span id="__span-35-27"><span class="w">             </span><span class="c1">// Ejecutamos un SELECT y obtenemos la tabla films en un ResultSet</span>
</span><span id="__span-35-28"><span class="w">             </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="n">sql</span><span class="p">);)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-29"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-30"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Se ha producido un error al insertar el film. Mensaje: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-35-31"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-35-32"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-35-33">
</span><span id="__span-35-34"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-35"><span class="w">        </span><span class="n">insertFilmFijo</span><span class="p">();</span>
</span><span id="__span-35-36"><span class="w">        </span><span class="n">insertFilmParametros</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="s">"Episode VIII"</span><span class="p">,</span><span class="w"> </span><span class="s">"The last Jedi"</span><span class="p">);</span>
</span><span id="__span-35-37"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-35-38"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> </div> <h2 id="borrado-delete">Borrado (<code>delete</code>)<a class="headerlink" href="#borrado-delete" title="Permanent link">¶</a></h2> <p>Para eliminar un registro solo hay que desplazar el cursor al registro deseado y llamar al método:</p> <ul> <li> <p><strong><code>void deleteRow()</code></strong>: elimina el registro actual del <code>ResultSet</code> y también de la base de datos.</p> <div class="admonition example"> <p class="admonition-title">El siguiente código borra el tercer registro de la tabla <code>films</code>:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-36-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._09_Borrado</span><span class="p">;</span>
</span><span id="__span-36-2">
</span><span id="__span-36-3"><span class="kn">import</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_PoolObject.HikariCPSingleton</span><span class="p">;</span>
</span><span id="__span-36-4">
</span><span id="__span-36-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.*</span><span class="p">;</span>
</span><span id="__span-36-6">
</span><span id="__span-36-7"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EjemploDeleteRow</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-8">
</span><span id="__span-36-9"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-10"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"SELECT * FROM films"</span><span class="p">;</span>
</span><span id="__span-36-11"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
</span><span id="__span-36-12"><span class="w">             </span><span class="n">Statement</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_SCROLL_SENSITIVE</span><span class="p">,</span><span class="w"> </span><span class="n">ResultSet</span><span class="p">.</span><span class="na">CONCUR_UPDATABLE</span><span class="p">);</span>
</span><span id="__span-36-13"><span class="w">             </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="n">sql</span><span class="p">);)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-14"><span class="w">            </span><span class="c1">// Desplazamos el cursor al tercer registro</span>
</span><span id="__span-36-15"><span class="w">            </span><span class="n">rs</span><span class="p">.</span><span class="na">absolute</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</span><span id="__span-36-16"><span class="w">            </span><span class="n">rs</span><span class="p">.</span><span class="na">deleteRow</span><span class="p">();</span>
</span><span id="__span-36-17"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-18"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Error de SQL: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-36-19"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-36-20"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-36-21"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> </div> </li> </ul> <h2 id="sentencias-predefinidas">Sentencias predefinidas<a class="headerlink" href="#sentencias-predefinidas" title="Permanent link">¶</a></h2> <p>Para solucionar el problema de crear sentencias sql complejas, se utiliza <code>PreparedStatement</code>.</p> <p>JDBC dispone de un objeto derivado del <code>Statement</code> que se llama <code>PreparedStatement</code>, al que se le pasa la sentencia SQL en el momento de crearlo, no en el momento de ejecutar la sentencia (como pasaba con <code>Statement</code>). Y además esta sentencia puede admitir parámetros, lo que nos puede ir muy bien en determinadas ocasiones.</p> <p>De cualquier modo, <code>PreparedStatement</code> presenta ventajas sobre su antecesor <code>Statement</code> cuando nos toque trabajar con sentencias que se hayan de ejecutar varias veces. La razón es que cualquier sentencia SQL, cuando se envía al SGBD será compilada antes de ser ejecutada.</p> <ul> <li>Utilizando un objeto <code>Statement</code>, cada vez que hacemos una ejecución de una sentencia, ya sea vía <code>executeUpdate</code> o bien vía <code>executeQuery</code>, el SGBD la compilará, ya que le llegará en forma de cadena de caracteres.</li> <li>En cambio, al <code>PreparedStament</code> la sentencia nunca varía y por lo tanto se puede compilar y guardar dentro del mismo objeto, por lo que las siguientes veces que se ejecute no habrá que compilarse. Esto reducirá sensiblemente el tiempo de ejecución.</li> </ul> <p>En algunos sistemas gestores, además, usar <code>PreparedStatements</code> puede llegar a suponer más ventajas, ya que utilizan la secuencia de bytes de la sentencia para detectar si se trata de una sentencia nueva o ya se ha servido con anterioridad. De esta manera se propicia que el sistema guarde las respuestas en la memoria caché, de manera que se puedan entregar de forma más rápida.</p> <p>La principal diferencia de los objetos <code>PreparedStatement</code> en relación a los <code>Statement</code>, es que en los primeros se les pasa la sentencia SQL predefinida en el momento de crearlo. Como la sentencia queda predefinida, ni los métodos <code>executeUpdate</code> ni <code>executeQuery</code> requerirán ningún parámetro. Es decir, justo al revés que en el <code>Statement</code>.</p> <p>Los parámetros de la sentencia se marcarán con el símbolo de interrogación (<code>?</code>) Y se identificarán por la posición que ocupan en la sentencia, empezando a contar desde la izquierda a partir del número 1. El valor de los parámetros se asignará utilizando el método específico, de acuerdo con el tipo de datos a asignar. El nombre empezará por <code>set</code> y continuará con el nombre del tipo de datos (ejemplos: <code>setString</code>, <code>setInt</code>, <code>setLong</code>, <code>setBoolean</code> …). Todos estos métodos siguen la misma sintaxis:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-37-1"><span class="n">setXXXX</span><span class="p">(</span><span class="o">&lt;</span><span class="n">posiciónEnLaSentenciaSQL</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">valor</span><span class="o">&gt;</span><span class="p">);</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition example"> <p class="admonition-title">con PreparedStatement</p> <p>Este es el mismo método para insertar y eliminar un <code>film</code> pero usando <code>PreparedStatement</code>:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-38-1"><span class="kn">package</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._10_Predefinidas</span><span class="p">;</span>
</span><span id="__span-38-2">
</span><span id="__span-38-3"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
</span><span id="__span-38-4"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
</span><span id="__span-38-5"><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
</span><span id="__span-38-6"><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Scanner</span><span class="p">;</span>
</span><span id="__span-38-7">
</span><span id="__span-38-8"><span class="kn">import</span><span class="w"> </span><span class="nn">es.martinezpenya.ejemplos.UD10._03_Patrones._02_PoolObject.HikariCPSingleton</span><span class="p">;</span>
</span><span id="__span-38-9">
</span><span id="__span-38-10"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EjemploInsercionBorradoConPreparedStatement</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-11">
</span><span id="__span-38-12"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">insertFilmPrepared</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">episode</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-13"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"INSERT INTO films (id, episode, title) VALUES (?,?,?)"</span><span class="p">;</span>
</span><span id="__span-38-14"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span><span class="w"> </span><span class="c1">// Obtener conexión del pool</span>
</span><span id="__span-38-15"><span class="w">             </span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">pst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">sql</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-16"><span class="w">         </span><span class="c1">// Asignamos los valores a los parámetros</span>
</span><span id="__span-38-17"><span class="w">            </span><span class="n">pst</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
</span><span id="__span-38-18"><span class="w">            </span><span class="n">pst</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">episode</span><span class="p">);</span>
</span><span id="__span-38-19"><span class="w">            </span><span class="n">pst</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="p">);</span>
</span><span id="__span-38-20"><span class="w">         </span><span class="c1">// Ejecutamos la sentencia preparada sin peligro de SQL Injection</span>
</span><span id="__span-38-21"><span class="w">            </span><span class="n">pst</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
</span><span id="__span-38-22"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-23"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Se ha producido un error al insertar el film. Mensaje: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-38-24"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-38-25"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-38-26">
</span><span id="__span-38-27"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">deleteFilmPrepared</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-28"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"DELETE FROM films WHERE id = ?"</span><span class="p">;</span>
</span><span id="__span-38-29"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HikariCPSingleton</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span><span class="w"> </span><span class="c1">// Obtener conexión del pool</span>
</span><span id="__span-38-30"><span class="w">             </span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">pst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">sql</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-31"><span class="w">            </span><span class="c1">// Asignamos el valor al parámetro</span>
</span><span id="__span-38-32"><span class="w">            </span><span class="n">pst</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
</span><span id="__span-38-33"><span class="w">            </span><span class="c1">// Ejecutamos la sentencia preparada sin peligro de SQL Injection</span>
</span><span id="__span-38-34"><span class="w">            </span><span class="n">pst</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
</span><span id="__span-38-35"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SQLException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-36"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Se ha producido un error al borrar el film. Mensaje: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
</span><span id="__span-38-37"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-38-38"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-38-39">
</span><span id="__span-38-40"><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-41"><span class="w">        </span><span class="n">insertFilmPrepared</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="s">"Episode VIII"</span><span class="p">,</span><span class="w"> </span><span class="s">"The last Jedi"</span><span class="p">);</span>
</span><span id="__span-38-42"><span class="w">        </span><span class="n">Scanner</span><span class="w"> </span><span class="n">sc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>
</span><span id="__span-38-43"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Pausa, pulsa ENTER para borrar el film introducido...."</span><span class="p">);</span>
</span><span id="__span-38-44"><span class="w">     </span><span class="n">sc</span><span class="p">.</span><span class="na">nextLine</span><span class="p">();</span>
</span><span id="__span-38-45"><span class="w">        </span><span class="n">deleteFilmPrepared</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
</span><span id="__span-38-46"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-38-47"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div> </div> <h3 id="ventajas-de-preparedstatement-desde-el-punto-de-vista-de-seguridad">Ventajas de <code>PreparedStatement</code> desde el Punto de Vista de Seguridad<a class="headerlink" href="#ventajas-de-preparedstatement-desde-el-punto-de-vista-de-seguridad" title="Permanent link">¶</a></h3> <p><strong><code>PreparedStatement</code></strong> ofrece varias ventajas en términos de seguridad, principalmente al prevenir ataques de inyección SQL.</p> <p><strong>Prevención de Inyección SQL:</strong></p> <div class="admonition info"> <p class="admonition-title">Definición</p> <p>La <strong>inyección SQL</strong> es un tipo de ataque en el que un atacante inserta o "inyecta" código SQL malicioso en una consulta a través de entradas de usuario. Esto puede permitir a un atacante ejecutar comandos SQL no autorizados, acceder a datos sensibles o manipular la base de datos de formas inesperadas.</p> </div> <p><strong>Ejemplo de Inyección SQL:</strong></p> <p>Supongamos que tienes un código que construye una consulta SQL concatenando cadenas de texto:</p> <div class="language-java highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-39-1"><span class="n">String</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"SELECT * FROM usuarios WHERE username = '"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"' AND password = '"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"'"</span><span class="p">;</span>
</span></code></pre></div></td></tr></table></div> <p>Si un atacante proporciona un <code>username</code> como <code>' OR '1'='1</code> y una <code>password</code> como <code>' OR '1'='1</code>, la consulta resultante sería:</p> <div class="language-sql highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-40-1"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">usuarios</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">''</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="s1">'1'</span><span class="o">=</span><span class="s1">'1'</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">''</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="s1">'1'</span><span class="o">=</span><span class="s1">'1'</span>
</span></code></pre></div></td></tr></table></div> <p>Esta consulta siempre devolvería todos los registros de la tabla <code>usuarios</code>, lo que podría permitir al atacante acceder a datos que no deberían estar disponibles.</p> <h2 id="pildoras-informaticas-relacionadas">Píldoras informáticas relacionadas<a class="headerlink" href="#pildoras-informaticas-relacionadas" title="Permanent link">¶</a></h2> <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" frameborder="0" height="315" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/videoseries?si=AEnj5v1FyQu9y8-V&amp;list=PLU8oAlHdN5BktAXdEVCLUYzvDyqRQJ2lk" title="YouTube video player" width="100%"></iframe> </div> <aside class="md-source-file"> <span class="md-source-file__fact"> <span class="md-icon" title="Última actualización"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="29 de diciembre de 2025 19:46:58 UTC">29 de diciembre de 2025</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component="top" hidden="" type="button"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Volver al principio </button> </main> <footer class="md-footer"> <nav aria-label="Pie" class="md-footer__inner md-grid"> <a aria-label="Anterior: T04 Calculadora JavaFX" class="md-footer__link md-footer__link--prev" href="../UD09/UD09_T04_Calculadora_en_JavaFX_IntelliJ_ES.html"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </div> <div class="md-footer__title"> <span class="md-footer__direction"> Anterior </span> <div class="md-ellipsis"> T04 Calculadora JavaFX </div> </div> </a> <a aria-label="Siguiente: Ejercicios" class="md-footer__link md-footer__link--next" href="UD10_ejercicios_ES.html"> <div class="md-footer__title"> <span class="md-footer__direction"> Siguiente </span> <div class="md-ellipsis"> Ejercicios </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> © 2025 David Martínez licensed under CC BY-NC-SA 4.0 </div> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> <div class="md-social"> <a class="md-social__link" href="https://youtube.com/@martinezpenya" rel="noopener" target="_blank" title="youtube.com"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M23.498 6.186a3.02 3.02 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.02 3.02 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.02 3.02 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.02 3.02 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814M9.545 15.568V8.432L15.818 12z"></path></svg> </a> <a class="md-social__link" href="https://linkedin.com/in/martinezpenya" rel="noopener" target="_blank" title="linkedin.com"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg> </a> <a class="md-social__link" href="https://github.com/martinezpenya" rel="noopener" target="_blank" title="github.com"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> <a class="md-social__link" href="https://buymeacoffee.com/martinezpenya" rel="noopener" target="_blank" title="Buy me a coffee"> <svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M64 64c0-17.7 14.3-32 32-32h352c70.7 0 128 57.3 128 128s-57.3 128-128 128c0 53-43 96-96 96H160c-53 0-96-43-96-96zm448 96c0-35.3-28.7-64-64-64v128c35.3 0 64-28.7 64-64M64 448h384c17.7 0 32 14.3 32 32s-14.3 32-32 32H64c-17.7 0-32-14.3-32-32s14.3-32 32-32"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["header.autohide", "content.action.edit", "content.code.copy", "content.code.select", "content.code.anotate", "toc.follow", "toc.integrate", "navigation.top", "navigation.footer"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script> <script src="../assets/javascripts/bundle.79ae519e.min.js"></script> <script src="../js/mathjax-config.js"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg-full.js"></script> </body> </html>